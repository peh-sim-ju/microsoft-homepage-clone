// For license information, see `http://launch-ENf7805d09fd1b455883333cdf34ee4ca2.js`.
window._satellite=window._satellite||{},window._satellite.container={buildInfo:{minified:!0,buildDate:"2025-05-02T17:39:34Z",turbineBuildDate:"2024-08-22T17:32:44Z",turbineVersion:"28.0.0"},environment:{id:"ENf7805d09fd1b455883333cdf34ee4ca2",stage:"production"},dataElements:{isSurfacePDP:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t=new RegExp("/d/surface"),e=new RegExp("/p/surface");return t.test(window.location.pathname.toLowerCase())||e.test(window.location.pathname.toLowerCase())}}},isSurfaceCategory:{modulePath:"core/src/lib/dataElements/cookie.js",settings:{name:"test"}},isSurfaceBusiness:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return new RegExp("store/b/surfaceforbusiness").test(window.location.pathname.toLowerCase())}}},PageInfo:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){try{var t,e,n={pagename:"other",pageName:"other",pageType:"other",path:window.location.pathname.toLowerCase(),reflc:"",muid:"",pT:"",logRuleCall:function(t,e,n){if("object"==typeof _TMutils)_TMutils.logRuleCall(t,e,n);else try{_satellite.logger.error("error in logging and no _satellite obj")}catch(t){}},getQSParam:function(t,e){var n=0,o=t.length,a=[];for(n=0;n<o;n++)if((a=t[n].split("="))[0].toLowerCase()==e.toLowerCase()&&a[1])return a[1];return""},readCookie:function(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null},createCookie:function(t,e,n){var o,a="",r=~window.location.host.indexOf("microsoft.com")?"; domain=.microsoft.com; path=/; ":"; path=/; ";n&&((o=new Date).setTime(o.getTime()+24*n*60*60*1e3),a="; expires="+o.toGMTString()),document.cookie=t+"="+e+a+r}},o="",a=[],r={};if(document.referrer&&(reflc=document.referrer.toLowerCase()),0==(o=window.location.search?window.location.search:"").indexOf("?n=ensighten.html?")&&(o=o.substring(17)),0==o.indexOf("?")&&(o=o.substring(1)),a=(o=(o=o.replace(/%20&%20/g,"%20%26%20")).replace(/ & /g,"%20%26%20")).split("&"),~window.location.host.indexOf("compass-ssl.xboxlive.com")||~window.location.host.indexOf("query.prod.cms.rt.microsoft.com"))n.muid=n.getQSParam(a,"muid"),n.pageName=n.getQSParam(a,"pN"),n.pageType=n.pageName;else if("object"==typeof _pageBITags){e=(t=_pageBITags.pageTags).pageType.toLowerCase(),n.pageName=t.pageName,n.pageType=t.pageType;try{n.muid=n.readCookie("MUID")}catch(t){n.logRuleCall("muid err")}(~e.indexOf("pdp")||~e.indexOf("detail"))&&~n.path.indexOf("/configure/")&&(e="configure",n.pageType="configure")}try{(r={pdp:"detail","product details":"detail","sfw-pdp-pagetemplate":"detail","sfw-category-pagetemplate":"category","onestore-shoppingcart-template":"cart",congrats:"receipt"})[n.pageType.toLowerCase()]&&(n.pageType=r[n.pageType.toLowerCase()]),n.pT="receipt"==n.pageType?"rP":n.pageType,~window.location.pathname.indexOf("/b/")&&window.location.pathname.indexOf("RETg7o")<0&&(n.pageType="category")}catch(t){n.logRuleCall("pageTypeMapError",n.pageType)}n.pagename=n.pageName}catch(t){console.log("DataLayer: "+t.message)}}}},EventsHoliday:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"div.card, div#coreui-contentplacement-f5d4afi, div#coreui-contentplacement-lzrgp5j, div#coreui-contentplacement-h1khlym, div#coreui-contentplacement-y1o0trq, div#coreui-contentplacement-qxreqji, div#StoreLocations-HighlightHero-6ywe7ix div div div div ul, div#coreui-contentplacement-zlfss3q, div#coreui-hero-npd01s8 div div div ul, div#coreui-contentplacement-a4imfpx, div#coreui-contentplacement-grqvg59, div#coreui-featurecollection-t1clixa div section ul, div#coreui-contentplacement-fiqwvm2, div#coreui-contentplacement-bkhqr5t, div#coreui-contentplacement-ntwsdzm, div#StoreLocations-HighlightHero-0qj0sa2, div#coreui-contentplacement-pwrxlcn, div.m-channel-placement a"}}},LocationInfo:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){try{var t,e,n,o={cc:"Unknown",geo:"",host:window.location.hostname.toLowerCase(),ll:"other",logRuleCall:function(t,e,n){if("object"==typeof _TMutils)_TMutils.logRuleCall(t,e,n);else try{_satellite.logger.error("error in logging and no _satellite obj")}catch(t){}},getQSParam:function(t,e){var n=0,o=t.length,a=[];for(n=0;n<o;n++)if((a=t[n].split("="))[0].toLowerCase()==e.toLowerCase()&&a[1])return a[1];return""},readCookie:function(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null},createCookie:function(t,e,n){var o,a="",r=~window.location.host.indexOf("microsoft.com")?"; domain=.microsoft.com; path=/; ":"; path=/; ";n&&((o=new Date).setTime(o.getTime()+24*n*60*60*1e3),a="; expires="+o.toGMTString()),document.cookie=t+"="+e+a+r}},a="",r=[],s="";if(0==(a=window.location.search?window.location.search:"").indexOf("?n=ensighten.html?")&&(a=a.substring(17)),0==a.indexOf("?")&&(a=a.substring(1)),r=(a=(a=a.replace(/%20&%20/g,"%20%26%20")).replace(/ & /g,"%20%26%20")).split("&"),~window.location.host.indexOf("compass-ssl.xboxlive.com")||~window.location.host.indexOf("query.prod.cms.rt.microsoft.com"))if(o.geo=o.getQSParam(r,"market"),o.ll=o.getQSParam(r,"culture")||o.getQSParam(r,"cl"),s=o.getQSParam(r,"orderLineItems"))try{s.indexOf("[")>-1?(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/%22%20Dis/g,"%20Dis")).replace(/portable%2013%22%20/g,"portable%2013%20")).replace(/%22%204K/g,"%204K")).replace(/%22Samsung%2049%22%20/g,"%22Samsung%2049%20")).replace(/%22%2F/g,"%2F")).replace(/5%22%20%2F/g,"5%2F")).replace(/%223%2F4%22%20/g,"%223%2F4%20")).replace(/15.6%22%20/g,"15.6%20")).replace(/%22/g,'"'),o.lineItems=JSON.parse(s)):(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/%22%20Dis/g,"%20Dis")).replace(/portable%2013%22%20/g,"portable%2013%20")).replace(/%22Samsung%2049%22%20/g,"%22Samsung%2049%20")).replace(/%22%204K/g,"%204K")).replace(/%22%2F/g,"%2F")).replace(/5%22%20%2F/g,"5%2F")).replace(/%223%2F4%22%20/g,"%223%2F4%20")).replace(/15.6%22%20/g,"15.6%20"),o.lineItems=JSON.parse(decodeURIComponent(s)))}catch(t){o.logRuleCall("jsonparse error","jsonparse error",window.location.search),_satellite.logger.error("jsonparse error")}else o.logRuleCall("orderLineItems json missing");else"object"==typeof _pageBITags&&(n=(t=_pageBITags.pageTags).pageType.toLowerCase(),o.ll=t.mkt,o.lang=t.mkt.split("-")[0],o.geo=t.mkt.split("-")[1],(~n.indexOf("pdp")||~n.indexOf("detail"))&&"object"==typeof _pageBITags&&"object"==typeof _pageBITags.pageContracts&&"object"==typeof _pageBITags.pageContracts.ProductInfo&&(e=_pageBITags.pageContracts.ProductInfo,o.cc=e.cur));for(var i=0;i<o.lineItems.length;i++){try{decodeURIComponent(o.lineItems[i].ti)}catch(t){o.lineItems[i].ti&&o.lineItems[i].ti}o.lineItems[i].cur&&(o.cc=o.lineItems[i].cur)}var c="";"Unknown"==o.cc&&~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")&&"receipt"==(c=~window.location.href.indexOf("pN=congrats")?"receipt":"cart")&&o.logRuleCall("missingCC"+c+"_"+o.geo,"missingCC_"+o.geo,window.location.search);var u={US:"USD",AU:"AUD",BR:"BRL",CA:"CAD",CH:"CHF",DK:"DKK",GB:"GBP",JP:"JPY",MX:"MXN",NO:"NOK",RU:"RUB",SE:"SEK",AT:"EUR",BE:"EUR",CY:"EUR",DE:"EUR",ES:"EUR",FI:"EUR",FR:"EUR",GR:"EUR",IR:"EUR",IT:"EUR",LU:"EUR",NL:"EUR",PT:"EUR",NEVERHIT:"Unknown"};if("Unknown"==o.cc||""==o.cc)try{u[o.geo.toUpperCase()]&&(o.cc=u[o.geo.toUpperCase()])}catch(t){}"Unknown"==o.cc&&(window.location.href.indexOf('"EUR"')>-1||window.location.href.indexOf("%22EUR%22")>-1)&&(o.cc="EUR"),o.pagename=o.pageName,window.location=window.location||o}catch(t){console.log("DataLayer: "+t.message)}}}},ProductInfo:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t,e,n,o={busgrp:[],isprod:!1,itemprices:[],lineItems:[],pids:[],pidsku:[],pnames:[],prdCt:[],prdFam:[],prdPrCat:[],prdSecCat:[],prdSubCat:[],prdType:[],skus:[],quantities:[],totamount:0,totqty:0,purchaseID:""},a="",r=[],s="";if(document.referrer&&(reflc=document.referrer.toLowerCase()),0==(a=window.location.search?window.location.search:"").indexOf("?n=ensighten.html?")&&(a=a.substring(17)),0==a.indexOf("?")&&(a=a.substring(1)),r=(a=(a=a.replace(/%20&%20/g,"%20%26%20")).replace(/ & /g,"%20%26%20")).split("&"),~window.location.host.indexOf("compass-ssl.xboxlive.com")||~window.location.host.indexOf("query.prod.cms.rt.microsoft.com"))if(purchaseID=getQSParam(r,"orderId")||getQSParam(r,"id"),muid=getQSParam(r,"muid"),totamount=getQSParam(r,"totAmtWoTx"),s=getQSParam(r,"orderLineItems"),~reflc.indexOf("www.microsoft.com")&&window.navigator.userAgent.toLowerCase().indexOf("soasta")<0&&(isprod=!0),s)try{s.indexOf("[")>-1?(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/%22%20Dis/g,"%20Dis")).replace(/portable%2013%22%20/g,"portable%2013%20")).replace(/%22%204K/g,"%204K")).replace(/%22Samsung%2049%22%20/g,"%22Samsung%2049%20")).replace(/%22%2F/g,"%2F")).replace(/5%22%20%2F/g,"5%2F")).replace(/%223%2F4%22%20/g,"%223%2F4%20")).replace(/15.6%22%20/g,"15.6%20")).replace(/%22/g,'"'),lineItems=JSON.parse(s)):(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/%22%20Dis/g,"%20Dis")).replace(/portable%2013%22%20/g,"portable%2013%20")).replace(/%22Samsung%2049%22%20/g,"%22Samsung%2049%20")).replace(/%22%204K/g,"%204K")).replace(/%22%2F/g,"%2F")).replace(/5%22%20%2F/g,"5%2F")).replace(/%223%2F4%22%20/g,"%223%2F4%20")).replace(/15.6%22%20/g,"15.6%20"),lineItems=JSON.parse(decodeURIComponent(s)))}catch(t){logRuleCall("jsonparse error","jsonparse error",window.location.search),_satellite.logger.error("jsonparse error")}else logRuleCall("orderLineItems json missing");else if("object"==typeof _pageBITags){e=_pageBITags.pageTags.pageType.toLowerCase(),~window.location.host.toLowerCase().indexOf("www.microsoft.com")&&window.navigator.userAgent.toLowerCase().indexOf("soasta")<0&&(isprod=!0);try{muid=readCookie("MUID")}catch(t){logRuleCall("muid err")}~e.indexOf("category")||((~e.indexOf("pdp")||~e.indexOf("detail"))&&"object"==typeof _pageBITags&&"object"==typeof _pageBITags.pageContracts&&"object"==typeof _pageBITags.pageContracts.ProductInfo?(t=_pageBITags.pageContracts.ProductInfo,pids.push(t.id),skus.push(t.sku),pidsku.push(t.id+"-"+t.sku),prdCt.push(t.prdCt),prdPrCat.push(t.priCat),prdSecCat.push(t.prdSecCat),prdSubCat.push(t.prdSubCat),prdType.push(t.family),pnames.push(t.title),quantities.push(1),sales.push(_pageBITags.pageContracts.ProductInfo.rtPrice),quantities.push(1),itemprices.push(sales[0])):(~e.indexOf("pdp")||~e.indexOf("detail"))&&~path.indexOf("/configure/")&&(e="configure",pageType="configure"))}for(var i=0;i<lineItems.length;i++){n="",pids.push(lineItems[i].pId?lineItems[i].pId:""),skus.push(lineItems[i].sku?lineItems[i].sku:"");try{n=decodeURIComponent(lineItems[i].ti)}catch(t){n=lineItems[i].ti?lineItems[i].ti:""}pnames.push(n),sales.push(lineItems[i].tot&&void 0!==lineItems[i].txA&&void 0!==lineItems[i].q?lineItems[i].tot-lineItems[i].q*lineItems[i].txA:lineItems[i].tot),prdPrCat.push(lineItems[i].pC?lineItems[i].pC:""),prdFam.push(lineItems[i].pF?lineItems[i].pF:""),prdType.push(lineItems[i].pT?lineItems[i].pT:""),pidsku.push(pids[i]+"-"+skus[i]),quantities.push(lineItems[i].q?lineItems[i].q:1),totqty+=quantities[i],itemprices.push(sales[i]/quantities[i])}return o}}},isPurchase:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}},isHoliday:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t=window.location.pathname.toLowerCase(),e=new RegExp("(en-ca|fr-ca)/store/b/boxing-week"),n=new RegExp("(us|ca|jp|au)/store/b/cyber-monday"),o=new RegExp("(us|ca|jp|au)/store/b/black-friday"),a=new RegExp("/store/b/sale");return!!(e.test(t)||n.test(t)||o.test(t)||a.test(t))}}},isBusinessConsultation:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return new RegExp("store/b/business-consultation").test(window.location.pathname.toLowerCase())}}},isConsumerConsultation:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return new RegExp("store/b/online-computer-shopping-appointments").test(window.location.pathname.toLowerCase())}}},"Bing UET Custom - Amplify ":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t,e,n,o,a,r,s,i;t=window,e=document,n="script",o="//bat.bing.com/bat.js",t[a="uetq_Amplify"]=t[a]||[],r=function(){var e={ti:"149014572"};e.q=t[a],t[a]=new UET(e),t[a].push("pageLoad")},(s=e.createElement(n)).src=o,s.async=1,s.onload=s.onreadystatechange=function(){var t=this.readyState;t&&"loaded"!==t&&"complete"!==t||(r(),s.onload=s.onreadystatechange=null)},(i=e.getElementsByTagName(n)[0]).parentNode.insertBefore(s,i)}}}},extensions:{linkedin:{displayName:"LinkedIn Insight Tag",hostedLibFilesBaseUrl:"//5ef092d1efb5/21b18fecd107/66c260dbd76d/hostedLibFiles/EP56446adda5514f21aa663f9e3635ddaa/",settings:{insightTagID:"7850"},modules:{}},"google-adwords":{displayName:"Google Ads",hostedLibFilesBaseUrl:"//5ef092d1efb5/21b18fecd107/66c260dbd76d/hostedLibFiles/EP0c3eb682977f4498b44855d2e1d8c210/",modules:{}},"bing-ads-extension":{displayName:"Bing Ads UET Tag",hostedLibFilesBaseUrl:"//5ef092d1efb5/21b18fecd107/66c260dbd76d/hostedLibFiles/EP05eac6e292f1486a812623da300a51b4/",settings:{qname:"uetq_Amplify",tagid:"149014572",navTimingApi:!0,storeConvTrackCookies:!0},modules:{}},core:{displayName:"Core",hostedLibFilesBaseUrl:"//5ef092d1efb5/21b18fecd107/66c260dbd76d/hostedLibFiles/EP9f64ab5391d540b0bb8658a244bbeb36/",modules:{"core/src/lib/dataElements/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t){"use strict";t.exports=function(t){return t.source()}}},"core/src/lib/dataElements/cookie.js":{name:"cookie",displayName:"Cookie",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-cookie");t.exports=function(t){return o.get(t.name)}}},"core/src/lib/actions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t,e,n,o){"use strict";var a,r,s,i=n("@adobe/reactor-document"),c=n("./helpers/decorateCode"),u=n("./helpers/loadCodeSequentially"),d=n("../../../node_modules/postscribe/dist/postscribe"),l=(a=function(t){d(i.body,t,{error:function(t){o.logger.error(t.msg)}})},r=[],s=function(){if(i.body)for(;r.length;)a(r.shift());else setTimeout(s,20)},function(t){r.push(t),s()}),p=function(){if(i.currentScript)return i.currentScript.async;for(var t=i.querySelectorAll("script"),e=0;e<t.length;e++){var n=t[e];if(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/.test(n.src))return n.async}return!0}();t.exports=function(t,e){var n={settings:t,event:e},o=n.settings.source;if(o)return n.settings.isExternal?u(o).then((function(t){t&&l(c(n,t))})):void(p||"loading"!==i.readyState?l(c(n,o)):i.write?i.write(c(n,o)):l(c(n,o)))}}},"core/src/lib/events/libraryLoaded.js":{name:"library-loaded",displayName:"Library Loaded (Page Top)",script:function(t,e,n){"use strict";var o=n("./helpers/pageLifecycleEvents");t.exports=function(t,e){o.registerLibraryLoadedTrigger(e)}}},"core/src/lib/conditions/path.js":{name:"path",displayName:"Path Without Query String",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../helpers/textMatch");t.exports=function(t){var e=o.location.pathname;return t.paths.some((function(t){var n=t.valueIsRegex?new RegExp(t.value,"i"):t.value;return a(e,n)}))}}},"core/src/lib/events/pageBottom.js":{name:"page-bottom",displayName:"Page Bottom",script:function(t,e,n){"use strict";var o=n("./helpers/pageLifecycleEvents");t.exports=function(t,e){o.registerPageBottomTrigger(e)}}},"core/src/lib/conditions/domain.js":{name:"domain",displayName:"Domain",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../../../node_modules/escape-string-regexp/index.js");t.exports=function(t){var e=o.location.hostname;return t.domains.some((function(t){return e.match(new RegExp("(^|\\.)"+a(t)+"$","i"))}))}}},"core/src/lib/conditions/sessions.js":{name:"sessions",displayName:"Sessions",script:function(t,e,n){"use strict";var o=n("../helpers/visitorTracking"),a=n("./helpers/compareNumbers");t.exports=function(t){return a(o.getSessionCount(),t.operator,t.count)}}},"core/src/lib/conditions/dateRange.js":{name:"date-range",displayName:"Date Range",script:function(t){"use strict";t.exports=function(t){var e=new Date;return!(t.start&&e<new Date(t.start)||t.end&&e>new Date(t.end))}}},"core/src/lib/conditions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t){"use strict";t.exports=function(t,e){return t.source.call(e.element,e,e.target)}}},"core/src/lib/conditions/pathAndQuerystring.js":{name:"path-and-querystring",displayName:"Path And Query String",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../helpers/textMatch");t.exports=function(t){var e=o.location.pathname+o.location.search;return t.paths.some((function(t){var n=t.valueIsRegex?new RegExp(t.value,"i"):t.value;return a(e,n)}))}}},"core/src/lib/actions/helpers/decorateCode.js":{script:function(t,e,n,o){"use strict";var a=0,r=function(t){return t.settings.isExternal},s=function(t,e){return"<script>\n"+e+"\n</script>"},i=function(t,e){var n="__runScript"+ ++a;return _satellite[n]=function(e){e.call(t.event.element,t.event,t.event.target),delete _satellite[n]},'<script>_satellite["'+n+'"](function(event, target) {\n'+e+"\n});</script>"},c={javascript:function(t,e){return t.settings.global?s(t,e):i(t,e)},html:function(t,e){return r(t)?o.replaceTokens(e,t.event):e}};t.exports=function(t,e){return c[t.settings.language](t,e)}}},"core/src/lib/actions/helpers/loadCodeSequentially.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-promise"),a=n("./getSourceByUrl"),r=o.resolve();t.exports=function(t){var e=new o((function(e){var n=a(t);o.all([n,r]).then((function(t){var n=t[0];e(n)}))}));return r=e,e}}},"core/node_modules/postscribe/dist/postscribe.js":{script:function(t,e){var n,o;n=this,o=function(){return function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var a=o(n(1));t.exports=a.default},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}function r(){}function s(){var t=m.shift();if(t){var e=l.last(t);e.afterDequeue(),t.stream=i.apply(void 0,t),e.afterStreamStart()}}function i(t,e,n){function o(t){t=n.beforeWrite(t),f.write(t),n.afterWrite(t)}(f=new d.default(t,n)).id=g++,f.name=n.name||f.id,c.streams[f.name]=f;var a=t.ownerDocument,i={close:a.close,open:a.open,write:a.write,writeln:a.writeln};u(a,{close:r,open:r,write:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o(e.join(""))},writeln:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o(e.join("")+"\n")}});var l=f.win.onerror||r;return f.win.onerror=function(t,e,o){n.error({msg:t+" - "+e+": "+o}),l.apply(f.win,[t,e,o])},f.write(e,(function(){u(a,i),f.win.onerror=l,n.done(),f=null,s()})),f}function c(t,e,n){if(l.isFunction(n))n={done:n};else if("clear"===n)return m=[],f=null,void(g=0);n=l.defaults(n,p);var o=[t=/^#/.test(t)?window.document.getElementById(t.substr(1)):t.jquery?t[0]:t,e,n];return t.postscribe={cancel:function(){o.stream?o.stream.abort():o[1]=r}},n.beforeEnqueue(o),m.push(o),f||s(),t.postscribe}e.__esModule=!0;var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};e.default=c;var d=a(n(2)),l=o(n(4)),p={afterAsync:r,afterDequeue:r,afterStreamStart:r,afterWrite:r,autoFix:!0,beforeEnqueue:r,beforeWriteToken:function(t){return t},beforeWrite:function(t){return t},done:r,error:function(t){throw new Error(t.msg)},releaseAsync:!1},g=0,m=[],f=null;u(c,{streams:{},queue:m,WriteStream:d.default})},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){var n=p+e,o=t.getAttribute(n);return d.existy(o)?String(o):o}function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=p+e;d.existy(n)&&""!==n?t.setAttribute(o,n):t.removeAttribute(o)}e.__esModule=!0;var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},u=a(n(3)),d=o(n(4)),l=!1,p="data-ps-",g="ps-style",m="ps-script",f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),this.root=e,this.options=n,this.doc=e.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new u.default("",{autoFix:n.autoFix}),this.actuals=[e],this.proxyHistory="",this.proxyRoot=this.doc.createElement(e.nodeName),this.scriptStack=[],this.writeQueue=[],i(this.proxyRoot,"proxyof",0)}return t.prototype.write=function(){var t;for((t=this.writeQueue).push.apply(t,arguments);!this.deferredRemote&&this.writeQueue.length;){var e=this.writeQueue.shift();d.isFunction(e)?this._callFunction(e):this._writeImpl(e)}},t.prototype._callFunction=function(t){var e={type:"function",value:t.name||t.toString()};this._onScriptStart(e),t.call(this.win,this.doc),this._onScriptDone(e)},t.prototype._writeImpl=function(t){this.parser.append(t);for(var e=void 0,n=void 0,o=void 0,a=[];(e=this.parser.readToken())&&!(n=d.isScript(e))&&!(o=d.isStyle(e));)(e=this.options.beforeWriteToken(e))&&a.push(e);a.length>0&&this._writeStaticTokens(a),n&&this._handleScriptToken(e),o&&this._handleStyleToken(e)},t.prototype._writeStaticTokens=function(t){var e=this._buildChunk(t);return e.actual?(e.html=this.proxyHistory+e.actual,this.proxyHistory+=e.proxy,this.proxyRoot.innerHTML=e.html,l&&(e.proxyInnerHTML=this.proxyRoot.innerHTML),this._walkChunk(),l&&(e.actualInnerHTML=this.root.innerHTML),e):null},t.prototype._buildChunk=function(t){for(var e=this.actuals.length,n=[],o=[],a=[],r=t.length,s=0;s<r;s++){var i=t[s],c=i.toString();if(n.push(c),i.attrs){if(!/^noscript$/i.test(i.tagName)){var u=e++;o.push(c.replace(/(\/?>)/," "+p+"id="+u+" $1")),i.attrs.id!==m&&i.attrs.id!==g&&a.push("atomicTag"===i.type?"":"<"+i.tagName+" "+p+"proxyof="+u+(i.unary?" />":">"))}}else o.push(c),a.push("endTag"===i.type?c:"")}return{tokens:t,raw:n.join(""),actual:o.join(""),proxy:a.join("")}},t.prototype._walkChunk=function(){for(var t=void 0,e=[this.proxyRoot];d.existy(t=e.shift());){var n=1===t.nodeType;if(!n||!s(t,"proxyof")){n&&(this.actuals[s(t,"id")]=t,i(t,"id"));var o=t.parentNode&&s(t.parentNode,"proxyof");o&&this.actuals[o].appendChild(t)}e.unshift.apply(e,d.toArray(t.childNodes))}},t.prototype._handleScriptToken=function(t){var e=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),t.src=t.attrs.src||t.attrs.SRC,(t=this.options.beforeWriteToken(t))&&(t.src&&this.scriptStack.length?this.deferredRemote=t:this._onScriptStart(t),this._writeScriptToken(t,(function(){e._onScriptDone(t)})))},t.prototype._handleStyleToken=function(t){var e=this.parser.clear();e&&this.writeQueue.unshift(e),t.type=t.attrs.type||t.attrs.TYPE||"text/css",(t=this.options.beforeWriteToken(t))&&this._writeStyleToken(t),e&&this.write()},t.prototype._writeStyleToken=function(t){var e=this._buildStyle(t);this._insertCursor(e,g),t.content&&(e.styleSheet&&!e.sheet?e.styleSheet.cssText=t.content:e.appendChild(this.doc.createTextNode(t.content)))},t.prototype._buildStyle=function(t){var e=this.doc.createElement(t.tagName);return e.setAttribute("type",t.type),d.eachKey(t.attrs,(function(t,n){e.setAttribute(t,n)})),e},t.prototype._insertCursor=function(t,e){this._writeImpl('<span id="'+e+'"/>');var n=this.doc.getElementById(e);n&&n.parentNode.replaceChild(t,n)},t.prototype._onScriptStart=function(t){t.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(t)},t.prototype._onScriptDone=function(t){t===this.scriptStack[0]?(this.scriptStack.shift(),this.write.apply(this,t.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)):this.options.error({msg:"Bad script nesting or script finished twice"})},t.prototype._writeScriptToken=function(t,e){var n=this._buildScript(t),o=this._shouldRelease(n),a=this.options.afterAsync;t.src&&(n.src=t.src,this._scriptLoadHandler(n,o?a:function(){e(),a()}));try{this._insertCursor(n,m),n.src&&!o||e()}catch(t){this.options.error(t),e()}},t.prototype._buildScript=function(t){var e=this.doc.createElement(t.tagName);return d.eachKey(t.attrs,(function(t,n){e.setAttribute(t,n)})),t.content&&(e.text=t.content),e},t.prototype._scriptLoadHandler=function(t,e){function n(){t=t.onload=t.onreadystatechange=t.onerror=null}function o(){n(),null!=e&&e(),e=null}function a(t){n(),s(t),null!=e&&e(),e=null}function r(t,e){var n=t["on"+e];null!=n&&(t["_on"+e]=n)}var s=this.options.error;r(t,"load"),r(t,"error"),c(t,{onload:function(){if(t._onload)try{t._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){a({msg:"onload handler failed "+e+" @ "+t.src})}o()},onerror:function(){if(t._onerror)try{t._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){return void a({msg:"onerror handler failed "+e+" @ "+t.src})}a({msg:"remote script failed "+t.src})},onreadystatechange:function(){/^(loaded|complete)$/.test(t.readyState)&&o()}})},t.prototype._shouldRelease=function(t){return!/^script$/i.test(t.nodeName)||!!(this.options.releaseAsync&&t.src&&t.hasAttribute("async"))},t}();e.default=f},function(t){var e;e=function(){return function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var a=o(n(1));t.exports=a.default},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=a(n(2)),i=a(n(3)),c=o(n(6)),u=n(5),d={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},l=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),this.stream=n;var a=!1,i={};for(var u in s)s.hasOwnProperty(u)&&(o.autoFix&&(i[u+"Fix"]=!0),a=a||i[u+"Fix"]);a?(this._readToken=(0,c.default)(this,i,(function(){return e._readTokenImpl()})),this._peekToken=(0,c.default)(this,i,(function(){return e._peekTokenImpl()}))):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return t.prototype.append=function(t){this.stream+=t},t.prototype.prepend=function(t){this.stream=t+this.stream},t.prototype._readTokenImpl=function(){var t=this._peekTokenImpl();if(t)return this.stream=this.stream.slice(t.length),t},t.prototype._peekTokenImpl=function(){for(var t in d)if(d.hasOwnProperty(t)&&d[t].test(this.stream)){var e=i[t](this.stream);if(e)return"startTag"===e.type&&/script|style/i.test(e.tagName)?null:(e.text=this.stream.substr(0,e.length),e)}},t.prototype.peekToken=function(){return this._peekToken()},t.prototype.readToken=function(){return this._readToken()},t.prototype.readTokens=function(t){for(var e=void 0;e=this.readToken();)if(t[e.type]&&!1===t[e.type](e))return},t.prototype.clear=function(){var t=this.stream;return this.stream="",t},t.prototype.rest=function(){return this.stream},t}();for(var p in e.default=l,l.tokenToString=function(t){return t.toString()},l.escapeAttributes=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=(0,u.escapeQuotes)(t[n],null));return e},l.supports=s,s)s.hasOwnProperty(p)&&(l.browserHasFlaw=l.browserHasFlaw||!s[p]&&p)},function(t,e){"use strict";e.__esModule=!0;var n=!1,o=!1,a=window.document.createElement("div");try{var r="<P><I></P></I>";a.innerHTML=r,e.tagSoup=n=a.innerHTML!==r}catch(t){e.tagSoup=n=!1}try{a.innerHTML="<P><i><P></P></i></P>",e.selfClose=o=2===a.childNodes.length}catch(t){e.selfClose=o=!1}a=null,e.tagSoup=n,e.selfClose=o},function(t,e,n){"use strict";function o(t){var e=t.indexOf("-->");if(e>=0)return new u.CommentToken(t.substr(4,e-1),e+3)}function a(t){var e=t.indexOf("<");return new u.CharsToken(e>=0?e:t.length)}function r(t){var e,n,o;if(-1!==t.indexOf(">")){var a=t.match(d.startTag);if(a){var r=(e={},n={},o=a[2],a[2].replace(d.attr,(function(t,a){arguments[2]||arguments[3]||arguments[4]||arguments[5]?arguments[5]?(e[arguments[5]]="",n[arguments[5]]=!0):e[a]=arguments[2]||arguments[3]||arguments[4]||d.fillAttr.test(a)&&a||"":e[a]="",o=o.replace(t,"")})),{v:new u.StartTagToken(a[1],a[0].length,e,n,!!a[3],o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))});if("object"===(void 0===r?"undefined":c(r)))return r.v}}}function s(t){var e=r(t);if(e){var n=t.slice(e.length);if(n.match(new RegExp("</\\s*"+e.tagName+"\\s*>","i"))){var o=n.match(new RegExp("([\\s\\S]*?)</\\s*"+e.tagName+"\\s*>","i"));if(o)return new u.AtomicTagToken(e.tagName,o[0].length+e.length,e.attrs,e.booleanAttrs,o[1])}}}function i(t){var e=t.match(d.endTag);if(e)return new u.EndTagToken(e[1],e[0].length)}e.__esModule=!0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.comment=o,e.chars=a,e.startTag=r,e.atomicTag=s,e.endTag=i;var u=n(4),d={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e.EndTagToken=e.AtomicTagToken=e.StartTagToken=e.TagToken=e.CharsToken=e.CommentToken=e.Token=void 0;var a=n(5),r=(e.Token=function t(e,n){o(this,t),this.type=e,this.length=n,this.text=""},e.CommentToken=function(){function t(e,n){o(this,t),this.type="comment",this.length=n||(e?e.length:0),this.text="",this.content=e}return t.prototype.toString=function(){return"<!--"+this.content},t}(),e.CharsToken=function(){function t(e){o(this,t),this.type="chars",this.length=e,this.text=""}return t.prototype.toString=function(){return this.text},t}(),e.TagToken=function(){function t(e,n,a,r,s){o(this,t),this.type=e,this.length=a,this.text="",this.tagName=n,this.attrs=r,this.booleanAttrs=s,this.unary=!1,this.html5Unary=!1}return t.formatTag=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="<"+t.tagName;for(var o in t.attrs)if(t.attrs.hasOwnProperty(o)){n+=" "+o;var r=t.attrs[o];void 0!==t.booleanAttrs&&void 0!==t.booleanAttrs[o]||(n+='="'+(0,a.escapeQuotes)(r)+'"')}return t.rest&&(n+=" "+t.rest),t.unary&&!t.html5Unary?n+="/>":n+=">",null!=e&&(n+=e+"</"+t.tagName+">"),n},t}());e.StartTagToken=function(){function t(e,n,a,r,s,i){o(this,t),this.type="startTag",this.length=n,this.text="",this.tagName=e,this.attrs=a,this.booleanAttrs=r,this.html5Unary=!1,this.unary=s,this.rest=i}return t.prototype.toString=function(){return r.formatTag(this)},t}(),e.AtomicTagToken=function(){function t(e,n,a,r,s){o(this,t),this.type="atomicTag",this.length=n,this.text="",this.tagName=e,this.attrs=a,this.booleanAttrs=r,this.unary=!1,this.html5Unary=!1,this.content=s}return t.prototype.toString=function(){return r.formatTag(this,this.content)},t}(),e.EndTagToken=function(){function t(e,n){o(this,t),this.type="endTag",this.length=n,this.text="",this.tagName=e}return t.prototype.toString=function(){return"</"+this.tagName+">"},t}()
},function(t,e){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?t.replace(/([^"]*)"/g,(function(t,e){return/\\/.test(e)?e+'"':e+'\\"'})):e}e.__esModule=!0,e.escapeQuotes=n},function(t,e){"use strict";function n(t){return t&&"startTag"===t.type&&(t.unary=i.test(t.tagName)||t.unary,t.html5Unary=!/\/>$/.test(t.text)),t}function o(t,e){var o=t.stream,a=n(e());return t.stream=o,a}function a(t,e){var n=e.pop();t.prepend("</"+n.tagName+">")}function r(){var t=[];return t.last=function(){return this[this.length-1]},t.lastTagNameEq=function(t){var e=this.last();return e&&e.tagName&&e.tagName.toUpperCase()===t.toUpperCase()},t.containsTagName=function(t){for(var e,n=0;e=this[n];n++)if(e.tagName===t)return!0;return!1},t}function s(t,e,s){function i(){var e=o(t,s);e&&d[e.type]&&d[e.type](e)}var u=r(),d={startTag:function(n){var o=n.tagName;"TR"===o.toUpperCase()&&u.lastTagNameEq("TABLE")?(t.prepend("<TBODY>"),i()):e.selfCloseFix&&c.test(o)&&u.containsTagName(o)?u.lastTagNameEq(o)?a(t,u):(t.prepend("</"+n.tagName+">"),i()):n.unary||u.push(n)},endTag:function(n){u.last()?e.tagSoupFix&&!u.lastTagNameEq(n.tagName)?a(t,u):u.pop():e.tagSoupFix&&(s(),i())}};return function(){return i(),n(s())}}e.__esModule=!0,e.default=s;var i=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,c=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])},t.exports=e()},function(t,e){"use strict";function n(t){return null!=t}function o(t){return"function"==typeof t}function a(t,e,n){var o=void 0,a=t&&t.length||0;for(o=0;o<a;o++)e.call(n,t[o],o)}function r(t,e,n){for(var o in t)t.hasOwnProperty(o)&&e.call(n,o,t[o])}function s(t,e){return t=t||{},r(e,(function(e,o){n(t[e])||(t[e]=o)})),t}function i(t){try{return Array.prototype.slice.call(t)}catch(o){var e=(n=[],a(t,(function(t){n.push(t)})),{v:n});if("object"===(void 0===e?"undefined":p(e)))return e.v}var n}function c(t){return t[t.length-1]}function u(t,e){return!(!t||"startTag"!==t.type&&"atomicTag"!==t.type||!("tagName"in t)||!~t.tagName.toLowerCase().indexOf(e))}function d(t){return u(t,"script")}function l(t){return u(t,"style")}e.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.existy=n,e.isFunction=o,e.each=a,e.eachKey=r,e.defaults=s,e.toArray=i,e.last=c,e.isTag=u,e.isScript=d,e.isStyle=l}])},"object"==typeof e&&"object"==typeof t?t.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof e?e.postscribe=o():n.postscribe=o()}},"core/src/lib/actions/helpers/getSourceByUrl.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-load-script"),a=n("@adobe/reactor-promise"),r={},s={},i=function(t){return s[t]||(s[t]=o(t)),s[t]};_satellite.__registerScript=function(t,e){r[t]=e},t.exports=function(t){return r[t]?a.resolve(r[t]):new a((function(e){i(t).then((function(){e(r[t])}),(function(){e()}))}))}}},"core/src/lib/events/helpers/pageLifecycleEvents.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-window"),a=n("@adobe/reactor-document"),r=-1!==o.navigator.appVersion.indexOf("MSIE 10"),s="WINDOW_LOADED",i="DOM_READY",c="PAGE_BOTTOM",u=[c,i,s],d=function(t,e){return{element:t,target:t,nativeEvent:e}},l={};u.forEach((function(t){l[t]=[]}));var p=function(t,e){u.slice(0,m(t)+1).forEach((function(t){f(e,t)}))},g=function(){return"complete"===a.readyState?s:"interactive"===a.readyState?r?null:i:void 0},m=function(t){return u.indexOf(t)},f=function(t,e){l[e].forEach((function(e){h(t,e)})),l[e]=[]},h=function(t,e){var n=e.trigger,o=e.syntheticEventFn;n(o?o(t):null)};o._satellite=o._satellite||{},o._satellite.pageBottom=p.bind(null,c),a.addEventListener("DOMContentLoaded",p.bind(null,i),!0),o.addEventListener("load",p.bind(null,s),!0),o.setTimeout((function(){var t=g();t&&p(t)}),0),t.exports={registerLibraryLoadedTrigger:function(t){t()},registerPageBottomTrigger:function(t){l[c].push({trigger:t})},registerDomReadyTrigger:function(t){l[i].push({trigger:t,syntheticEventFn:d.bind(null,a)})},registerWindowLoadedTrigger:function(t){l[s].push({trigger:t,syntheticEventFn:d.bind(null,o)})}}}},"core/src/lib/helpers/textMatch.js":{script:function(t){"use strict";t.exports=function(t,e){if(null==e)throw new Error("Illegal Argument: Pattern is not present");return null!=t&&("string"==typeof e?t===e:e instanceof RegExp&&e.test(t))}}},"core/node_modules/escape-string-regexp/index.js":{script:function(t){"use strict";var e=/[|\\{}()[\]^$+*?.]/g;t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(e,"\\$&")}}},"core/src/lib/helpers/visitorTracking.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-cookie"),a=n("@adobe/reactor-document"),r=n("@adobe/reactor-window"),s=n("./getNamespacedStorage"),i="_sdsat_",c="visitorTracking",u="cookiesMigrated",d=s("localStorage",c),l=s("sessionStorage",c),p=function(){var t=l.getItem("landingPage");return t||(l.setItem("landingPage",r.location.href),l.setItem("landingTime",(new Date).getTime())),!t},g=function(){return l.getItem("landingPage")},m=function(){return Number(l.getItem("landingTime"))},f=function(){return Number(d.getItem("sessionCount"))},h=function(){return Number(d.getItem("pagesViewed"))},v=function(){var t=(new Date).getTime();return Math.floor((t-m())/1e3/60)},_=function(){return l.getItem("trafficSource")},b=function(){return Number(l.getItem("pagesViewed"))},w=function(){return 1===f()},y=function(t){t&&d.setItem("sessionCount",f()+1)},T=function(){l.setItem("pagesViewed",b()+1)},x=function(){d.setItem("pagesViewed",h()+1)},C=function(){l.getItem("trafficSource")||l.setItem("trafficSource",a.referrer)},L=function(){var t=p();y(t),x(),T(),C()};(function(){if(!d.getItem(u)){var t=o.get(i+"session_count");t&&d.setItem("sessionCount",t);var e=o.get(i+"lt_pages_viewed");e&&d.setItem("pagesViewed",e),d.setItem(u,!0)}})(),L(),t.exports={getLandingPage:g,getLandingTime:m,getMinutesOnSite:v,getSessionCount:f,getLifetimePageViewCount:h,getSessionPageViewCount:b,getTrafficSource:_,getIsNewVisitor:w}}},"core/src/lib/conditions/helpers/compareNumbers.js":{script:function(t){"use strict";var e={GREATER_THAN:">",LESS_THAN:"<",EQUALS:"="},n=function(t,n,o){switch(n){case e.GREATER_THAN:return t>o;case e.LESS_THAN:return t<o;case e.EQUALS:return t===o}};t.exports=n}},"core/src/lib/helpers/getNamespacedStorage.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-window"),a="com.adobe.reactor.core";t.exports=function(t,e){var n=a+"."+e;return{getItem:function(e){try{return o[t].getItem(n+"."+e)}catch(t){return null}},setItem:function(e,a){try{return o[t].setItem(n+"."+e,a),!0}catch(t){return!1}}}}}}}},"twitter-uwt":{displayName:"Twitter Universal Website Tag",hostedLibFilesBaseUrl:"//5ef092d1efb5/21b18fecd107/66c260dbd76d/hostedLibFiles/EP0393ce01ac3540acb78f103d8e58a5a0/",settings:{account_id:"o4co9"},modules:{}},"gtag.js":{displayName:"Google gtag",hostedLibFilesBaseUrl:"//5ef092d1efb5/21b18fecd107/66c260dbd76d/hostedLibFiles/EPafb38e52c35f4c8e9725c5b669a4431d/",settings:{conversionIdList:["923371515"]},modules:{"gtag.js/src/lib/gtagCode.js":{script:function(t,e,n,o){"use strict";var a=n("@adobe/reactor-load-script"),r=o.getExtensionSettings(),s=r.conversionIdList,i=r.dataLayerName,c="https://www.googletagmanager.com/gtag/js?id="+s[0];i&&(c="https://www.googletagmanager.com/gtag/js?id="+s[0]+"&l="+i),a(c),!window.dataLayer||Array.isArray(window.dataLayer)||i||console.log("window.dataLayer already exists and is not an array. Visit the gtag extension configuration in Launch and provide a custom data layer name of your choosing."),i?(window[i]=window[i]||[],window.gtag=function(){window[i].push(arguments)}):(window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)}),gtag("js",new Date),s.forEach((function(t){gtag("config",t)}))}}}}},company:{orgId:"EA76ADE95776D2EC7F000101@AdobeOrg",dynamicCdnEnabled:!1},property:{name:"Store",settings:{domains:["microsoft.com"],undefinedVarsReturnEmpty:!1,ruleComponentSequencingEnabled:!1},id:"PRb55c9879b37e451cb2349365f439f194"},rules:[{id:"RL0bcfb7ed292f400495880750aaae4dbc",name:"ENSSHIM",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-90}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:'if (typeof Bootstrapper !== \'object\') {\n\twindow.Bootstrapper = {};\n\tBootstrapper.imageRequest = function(a) {var c=new Image(0,0);c.src=a;return c};\n\tBootstrapper.insertScript = function(a, c, d, h) {\n                var p = document.getElementsByTagName("script"), g;\n                h = void 0 !== h ? h : !0;\n                if (void 0 !== c ? c : 1)\n                    for (g = 0; g < p.length; g++)\n                        if (p[g].src === a && p[g].readyState && /loaded|complete/.test(p[g].readyState))\n                            return;\n                if (d) {\n                    d = 1 == d && "object" == typeof b.scDataObj ? b.scDataObj : d;\n                    e.rand = Math.random() * ("1E" + (10 * Math.random()).toFixed(0));\n                    c = window.location.href;\n                    "object" === typeof d && d.PageID && (c = d.PageID,\n                    delete d.PageID);\n                    if ("object" === typeof d)\n                        for (g in d) {\n                            g = ~c.indexOf("#") ? c.slice(c.indexOf("#"), c.length) : "";\n                            c = c.slice(0, g.length ? c.length - g.length : c.length);\n                            c += ~c.indexOf("?") ? "&" : "?";\n                            for (k in d)\n                                c += k + "=" + d[k] + "&";\n                            c = c.slice(0, -1) + g;\n                            break\n                        }\n                    a += "?";\n                    h && (a += "r=" + e.rand + "&");\n                    a += "ClientID=" + encodeURIComponent(e.options.clientId) + "&PageID=" + encodeURIComponent(c)\n                }\n                (function(a, c, b) {\n                    var d = c.head || c.getElementsByTagName("head");\n                    setTimeout(function() {\n                        if ("item"in d) {\n                            if (!d[0]) {\n                                setTimeout(arguments.callee, 25);\n                                return\n                            }\n                            d = d[0]\n                        }\n                        var a = c.createElement("script");\n                        a.src = b;\n                        a.onload = a.onerror = function() {\n                            this.addEventListener && (this.readyState = "loaded")\n                        }\n                        ;\n                        d.insertBefore(a, d.firstChild)\n                    }, 0)\n                }\n                )(window, document, a)\n            }\n            ;\n            Bootstrapper.loadScriptCallback = function(a, c, b) {\n                var d = document.getElementsByTagName("script"), e;\n                b = d[0];\n                for (e = 0; e < d.length; e++)\n                    if (d[e].src === a && d[e].readyState && /loaded|complete/.test(d[e].readyState))\n                        try {\n                            c()\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        } finally {\n                            return\n                        }\n                d = document.createElement("script");\n                d.type = "text/javascript";\n                d.async = !0;\n                d.src = a;\n                d.onerror = function() {\n                    this.addEventListener && (this.readyState = "loaded")\n                }\n                ;\n                d.onload = d.onreadystatechange = function() {\n                    if (!this.readyState || "complete" === this.readyState || "loaded" === this.readyState) {\n                        this.onload = this.onreadystatechange = null;\n                        this.addEventListener && (this.readyState = "loaded");\n                        try {\n                            c.call(this)\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        }\n                    }\n                }\n                ;\n                b.parentNode.insertBefore(d, b)\n            }\n            ;\n}\n\n\nwindow._TMutils = {\n\tgetQueryParam : function (p,url) {\n\t\t\t//var url = window.location.search,\n\t\t\tvar match;\n\t\t\tif (window.location.href.indexOf("#") !== -1) {\n\t\t\t\turl += "&" + window.location.href.split("#")[1]\n\t\t\t}\n\t\t\tmatch = new RegExp("[?&]" + p + "=([^&]*)", "i").exec(url);\n\t\t\treturn match ? IRF.util.safeDecodeURIComponent(match[1].replace(/\\+/g, " ")) : null\n\t},\n  readCookie : function(name) {\n\t\tvar nameEQ = name + "=";\n\t\tvar ca = document.cookie.split(\';\');\n\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\tvar c = ca[i];\n\t\t\twhile (c.charAt(0)==\' \') c = c.substring(1,c.length);\n\t\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n\t\t}\n\t\treturn null;\n\t},\n\tcreateCookie : function(name,value,days) {\n\t\tvar expires = "";\n\t\tvar date;\n\t\tvar domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";\n\t\tif (days) {\n\t\t\tdate = new Date();\n\t\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\t\texpires = "; expires="+date.toGMTString();\n\t\t}\n\t\tdocument.cookie = name+"="+value+expires+domainstr;\n\t},\n\tsafeDecodeURIComponent : function (s) {\n\t\tif (s) {\n\t\t\ts = s.replace(/%([EF][0-9A-F])%([89AB][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2, hex3) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 224;\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\tif (n1 == 0 && n2 < 32) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n3 = parseInt(hex3, 16) - 128;\n\t\t\t\t\tvar n = (n1 << 12) + (n2 << 6) + n3;\n\t\t\t\t\tif (n > 65535) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\treturn String.fromCharCode(n)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([CD][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 192;\n\t\t\t\t\tif (n1 < 2) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\treturn String.fromCharCode((n1 << 6) + n2)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([0-7][0-9A-F])/gi, function (code, hex) {\n\t\t\t\t\treturn String.fromCharCode(parseInt(hex, 16))\n\t\t\t\t});\n\t\t\ts = s.replace("+", " ")\n\t\t}\n\t\treturn s\n\t},\n\tlogRuleCall : function (ruleName,debugParams,imageURL) {\n\t\tvar pType = "other";var market = "en-us";var cookieMSFPC = "msfpc";\n\t\tvar ff2,ff3,ff4,ff5,ff6;ff2=ff3=ff4=ff5=ff6="";\n\t\tvar jsDomain = encodeURIComponent(window.location.hostname.toLowerCase());\n        if (typeof _TMDL == "object") {pType = _TMDL.pageType;market = _TMDL.ll;}\n        function impGuid() {var result,i,j;result="";\n            for (j = 0; j < 32; j++) {if (j == 8 || j == 12 || j == 16 || j == 20)result = result + "-";\n                i = Math.floor(Math.random() * 16).toString(16).toUpperCase();result=result+i;}return result;}\n\t\t(function(imageURL){\t\n\t\tvar climit,temp2,temp3,temp4,URLlen;climit=255;URLlen=imageURL.length;\n\t\tif (URLlen <= climit) {ff2=imageURL;}\n\t\tif (URLlen > climit){ff2 = imageURL.slice(0,climit);temp2 = imageURL.slice(climit,URLlen);if (temp2.length <= climit){ff3=temp2;}else {ff3 = temp2.slice(0,climit);temp3 = temp2.slice(climit,URLlen);if (temp3.length <= climit) {ff4=temp3;}else{ff4 = temp3.slice(0,climit);temp4 = temp3.slice(climit,URLlen);if (temp4.length <= climit) {ff5=temp4;}else{ff5=temp4.slice(0,climit);ff6= temp4.slice(climit,URLlen);}}}}})(encodeURIComponent(imageURL));\n\t\tvar dtUTCTime = new Date;\n        var curUTCTime = dtUTCTime.getUTCFullYear() + "-" + dtUTCTime.getUTCMonth() + 1 + "-" + dtUTCTime.getUTCDate() + "T" + dtUTCTime.getUTCHours() + ":" + dtUTCTime.getUTCMinutes() + ":" + dtUTCTime.getUTCSeconds() + "." + dtUTCTime.getUTCMilliseconds() + "Z";\n        var str = "https://web.vortex.data.microsoft.com/collect/v1/t.js?ver\\x3d%272.1%27\\x26name\\x3d%27Ms.Webi.PageView%27\\x26";\n        str += "time\\x3d\'" + curUTCTime + "\'" + "\\x26appId\\x3d%27JS%3AUniStore%27\\x26-ver\\x3d%271.0%27\\x26-" + "impressionGuid\\x3d%27" + impGuid() + "%27" + "\\x26-pageName\\x3d%27" + encodeURIComponent(ruleName) + "%27" + "\\x26-pageType\\x3d%27" + pType + "%27" + "\\x26-market\\x3d%27" + encodeURIComponent(market) + "%27" + "\\x26-uri\\x3d%27" + encodeURIComponent(document.URL) + "%27" + "\\x26-referrerUri\\x3d%27" + encodeURIComponent(document.referrer) + "%27" + "\\x26-pageTags\\x3d%27%7B%22flightring%22%3A%22" + encodeURIComponent(debugParams) + "%22" + ",%22field2%22%3A%22" + encodeURIComponent(ff2) + "%22,%22field3%22%3A%22" + encodeURIComponent(ff3) +"%22,%22field4%22%3A%22" + encodeURIComponent(ff4) + "%22,%22field5%22%3A%22" + encodeURIComponent(ff5) +"%22,%22field6%22%3A%22" + encodeURIComponent(ff6) +"%22%7D%27\\x26-behavior\\x3d0" + "\\x26*baseType\\x3d%27Ms.Content.PageView%27\\x26*cookieEnabled\\x3dtrue\\x26*isJs\\x3dtrue" + "\\x26*title\\x3d%27" + encodeURIComponent(document.title) + "%27" + "\\x26*isLoggedIn\\x3dfalse\\x26*flashInstalled\\x3dfalse\\x26ext-app-env\\x3d%27DEV%27\\x26ext-javascript-libVer\\x3d%274.2.11%27" + "\\x26ext-javascript-domain\\x3d%27" + jsDomain + "%27" + "\\x26ext-javascript-msfpc\\x3d%27" + cookieMSFPC + "%27" + "\\x26ext-javascript-userConsent\\x3dfalse";\n        var imgTag = new Image;imgTag.src = str;\n\t}\n};\n',language:"javascript"}}]},{id:"RL1bd4a77a2f604eb69d942ed8e47a1507",name:"Media_/fr-fr/store/b/sale",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/fr-fr/store/b/sale"},{value:"/fr-fr/store/b/sale/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n// ADNXS\n   //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n\n\n//DoubleClick\n  //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Deals"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Now"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Product Options"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  \n//Yahoo\n  //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/fr-fr/store/b/sale");\n}\n  ',language:"javascript"}}]},{id:"RL1cd84423be164e20b3a15f9776da8f69",name:"GlobalSurfaceEngagements/Yahoo-Xndr-Adobe",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|gb|jp|ca|de|au|es|nl|fr)/.*surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/sessions.js",settings:{count:1,operator:"="}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// GlobalSurfaceEngagements/Yahoo-Xndr-Adobe\nvar micClick = 'p > a[href]';\nvar micClick2 = 'div > a[href]';\nvar micClick3 = 'span > a[href]';\nvar micClick3 = 'u > a[href]';\nvar micClick4 = 'font > a[href]';\nvar secondConfig = 'button[data-action*=\"Configure\"]';\nvar cardClick = 'div[class*=\"slide-item\"]';\nvar cardClick2 = 'div[class*=\"material-card\"]';\nvar hasClicked = false;\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        if (!hasClicked) {\n            let varInt = parseInt(Math.random() * 10000000000000);;\n            var image1 = new Image(1, 1);\n            image1.src = 'https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=MSFT_Store_SiteEngagement&custom1=$$SOME_CP_MACRO$$&cachebuster=' + varInt;\n\n            var image2 = new Image(1, 1);\n            image2.src = \"https://secure.adnxs.com/px?id=1268102&t=2\";\n\n            var image3 = new Image(1, 1);\n            image3.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n            hasClicked = true;\n        }\n\n    });\n}\n\ntry {\n    attachPixels(micClick);\n    attachPixels(micClick2);\n    attachPixels(micClick3);\n    attachPixels(micClick4);\n    attachPixels(secondConfig);\n    attachPixels(cardClick);\n    attachPixels(cardClick2);\n}\ncatch (err) {\n    _satellite.logger.error(\"Global Engagements\");\n}",language:"javascript"}}]},{id:"RL20db49c5be364fdfa5b97205edce7c28",name:"CandyCrush/Bing",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/p/candy-crush-saga",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2025-01-31T00:00:00Z",start:"2023-11-01T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    (function (w, d, t, r, u) { var f, n, i; w[u] = w[u] || [], f = function () { var o = { ti: "355025700", enableAutoSpaTracking: true }; o.q = w[u], w[u] = new UET(o), w[u].push("pageLoad") }, n = d.createElement(t), n.src = r, n.async = 1, n.onload = n.onreadystatechange = function () { var s = this.readyState; s && s !== "loaded" && s !== "complete" || (f(), n.onload = n.onreadystatechange = null) }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i) })(window, document, "script", "//bat.bing.com/bat.js", "uetq_Candy");\n    \n    var getButton = \'button[id*="buttonPanel_AppIdentityBuyButton"]\';\n    var installButton = \'button[id*="PlayBar_AppIdentityOpenButton"]\';\n\n    attachPixels(getButton);\n    attachPixels(installButton);\n} catch (e) {\n    console.log("Candy Crush-Bing has failed");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        window.uetq_Candy = window.uetq_Candy || []; \n        window.uetq_Candy.push(\'event\', \'click\', {});\n    });\n}\n',language:"javascript"}}]},{id:"RL245098dcb50d40aebde2378195845fec",name:"US-SurfaceAddToCart-TikTok",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-01-31T00:00:00Z",start:"2023-10-09T00:00:00Z"}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/.*surface",valueIsRegex:!0},{value:"/en-us/store/configure/.*surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var firstConfig = \'a[href*="/store/configure"]\';\n    var secondConfig = \'button[data-action*="Configure"]\';\n    var addToCart = \'button[data-automation-test-id*="configuratorV3-BottomBar-button"]\';\n\n    attachPixels(firstConfig);\n    attachPixels(secondConfig);\n    attachPixels(addToCart);\n}\ncatch (err) {\n    _satellite.logger.error("TikTok Add to Cart Failed");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var\ta = "" + (Math.random() * 10000000000000);\n        var pageLoad = new Image(1, 1);\n        pageLoad.src = "https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=IDCKEOVFBC77U6580FHDM0&event=AddToCart&event_id=" + a;\n    });\n}\n',language:"javascript"}}]},{id:"RL325bf34eaeac4b8e8ae3b9fac3cf4c62",name:"BoostSurfacePDPs",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/",valueIsRegex:!0},{value:"/en-us/store/configure/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"var allClicks = '[href]';\nvar buildButton = 'button[data-action*=\"ConfigureDevice\"]';\nvar addToCart = 'button[data-automation-test-id*=\"configurator\"]';\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        window.uetq_Amplify = window.uetq_Amplify || [];\n        if (_TMDL.pageName === \"Configure\") {\n            window.uetq_Amplify.push('event', 'click', { 'event_label': _TMDL.path.split('/')[4] });\n        } else {\n            window.uetq_Amplify.push('event', 'click', { 'event_label': _TMDL.pageName });\n        }\n\n    });\n} \n\ntry {\n    (function (w, d, t, r, u) {\n        var f, n, i; w[u] = w[u] || [], f = function () {\n            var o = { ti: \"149014572\" }; o.q = w[u], w[u] = new UET(o), w[u].push(\"pageLoad\")\n        },\n            n = d.createElement(t), n.src = r, n.async = 1,\n            n.onload = n.onreadystatechange = function () {\n                var s = this.readyState; s && s !== \"loaded\" && s !== \"complete\" || (f(), n.onload = n.onreadystatechange = null)\n            }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i)\n    })(window, document, \"script\", \"//bat.bing.com/bat.js\", \"uetq_Amplify\");\n\n    attachPixels(allClicks);\n    attachPixels(buildButton);\n    attachPixels(addToCart);\n}\ncatch (err) {\n    _satellite.logger.error(\"Boost Surface PDP\");\n}",language:"javascript"}}]},{id:"RL3846f5bb89ac402c9528c708ad36d21f",name:"SurfaceGrowthCPE",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface-book-3",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface-go-2",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface-book-3",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface-go-2",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// OVERWRITES jquery contains to make it case insensitive\njQuery.expr[\':\'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid="",cN="",u="",hr="";\n\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("catch "+ actionName + " " + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + ";u1="\n\t\t+_TMDL.geo\n\t\t+";u2="+_TMDL.ll\n\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t+";u25="+pid\n\t\t+";u26="+encodeURIComponent(cN)\n\t\t+";u50="+encodeURIComponent(cN)\n\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+" u25="+pid+" u26="+cN+"\\t"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\ntry {\n\tattachAnalyticsToElement(\n\t\t"div#coreui-contentplacement-25bhfyl section.m-content-placement-item, div#coreui-contentplacement-34ednys section.m-content-placement-item, div#coreui-banner-0drta14 a",\n\t\t\'Configurations Add to Cart\',\n\t\t\'https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std\');\n} catch(clkerr) {\n\tconsole.log("Surface PDP Configs CPE Error");\n}\n\n\n',language:"javascript"}}]},{id:"RL463d31a0088348dfb14042f03eeb3071",name:"Facebook/TikTok SurfaceCopilot",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-10-31T00:00:00Z",start:"2024-06-02T00:00:00Z"}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/configure/.*/8tq2hq5xxkj9",valueIsRegex:!0},{value:"/en-us/store/configure/.*/8n9t09p96cmj",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var atc = \'button[data-automation-test-id*="checkout"]\';\n    attachPixels(atc);\n} catch (e) {\n    console.log("Rule has failed");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var meta = new Image(1, 1);\n        meta.src = "https://www.facebook.com/tr?id=1770559986549030&ev=AddToCart&noscript=1";\n\n        var tiktok = new Image(1, 1);\n        var randnum = (Math.random() * 10000000000000000);\n        tiktok.src = "https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=COSI0JRC77U1Q2BAH03G&event=AddtoCart&event_id=" + randnum;\n    });\n}',language:"javascript"}}]},{id:"RL4640885657f049d399cb5b426a59bb18",name:"LINKEDIN",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nLinkedIn tag\n*/\ntry\n{\n\tvar c=new Image(0,0);\n\tc.src="https://px.ads.linkedin.com/collect/?pid=7850&fmt=gif";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("LINKEDIN",err.message,c.src);}\n\t_satellite.logger.error("LINKEDIN");\t\n}\n',language:"javascript"}}]},{id:"RL4d95565cb7de40e784c80ee275c7b124",name:"TikTok_LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-us|en-gb|fr-fr|de-de)",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'try\n{\n!function (w, d, t) {\n  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};\n\n//part2\n  ttq.load(\'C5S71GC247CAE4T3VM1G\');\n  ttq.page();\n}(window, document, \'ttq\');\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("TikTok LP");\n}',language:"javascript"}}]},{id:"RL5340059915f54c6ca20016bf79db7c37",name:"LinkedIn/US/AddToCart",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/*.surface",valueIsRegex:!0},{value:"/en-us/store/configure/*.surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try {\n    var firstConfig = 'a[href*=\"/store/configure\"]';\n    var secondConfig = 'button[data-action*=\"Configure\"]';\n    var addToCart = 'button[data-automation-test-id*=\"configuratorV3-BottomBar-button\"]';\n\n    attachPixels(firstConfig);\n    attachPixels(secondConfig);\n    attachPixels(addToCart);\n}\ncatch (err) {\n    _satellite.logger.error(\"LinkedIn Add to Cart Failed\");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        var pageLoad = new Image(1, 1);\n        pageLoad.src = \"https://px.ads.linkedin.com/collect/?fmt=gif&url=https://www.microsoft.com/MSFTAddToCart&pid=7850\";\n    });\n}\n",language:"javascript"}}]},{id:"RL5c1f0ed8f9c64aa488ccab2558f160dc",name:"BingSurfClkCustom /d/ (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:80}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.pathname.toLowerCase().indexOf("/d/")&&~window.location.pathname.toLowerCase().indexOf("surface")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"\n\nvar tempobj; \n\ntry {\n\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\")<0 && (typeof uetq=='object')) {\n\n\t\ttempobj={};\n\t\t\n\t\tif (_TMDL.pidsku.length > 0) {\n\t\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\t\ttempobj.ecomm_pagetype = \"product\";\n\t\t\ttempobj.items = [\n\t\t\t\t{\n\t\t\t\t  'id': _TMDL.pidsku[0],\n\t\t\t\t  'category': 'surface',\n\t\t\t\t  'price' : _TMDL.sales[0]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\t\n\t\t// Configure Now CTA\n        /*\n\t\t$(document).on('mousedown','button[id*=\"ConfigureDeviceButton\"]','', function() {\n\t\t\twindow.uetq.push('event','configurenow', tempobj); \n\t\t});\n        */\n      \n\t\t// Configure Now CTA - Updated 7/19 to correct ID\n        jQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\n            window.uetq.push('event','configurenow', tempobj); \n         });\n      \n      \n\t\t// BuildYourBundle CTA\n        $(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]','', function() {\n\t\t\twindow.uetq.push('event','buildyourbundle', tempobj); \n\t\t});\n\t\t\t\n\t\t\n\t\t//check your eligibility CTA\n\t\t\n\t\t$(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n\t\t\twindow.uetq.push('event','checkeligibility', tempobj); \n\t\t});\n      \n      \t// Add to Cart button, particularly needed for Surface Go PDP -- Update 7/19 Surface GO PDP and configurator page do not appear to have this ID. \"add to cart\" only exists after the bundle is created on the configurator. \n        //This should likely be updated to use: jQuery(\"a:contains('Add to cart'),button:contains('Add to cart')\");\n\t\t$(document).on('mousedown','button[id*=\"buttons_AddToCartButton\"]','', function() {\n\t\t\twindow.uetq.push('event','addtocartbutton', tempobj); \n\t\t});\t\t\n\t}\n} catch(bingerr) {console.log(\"bing onclick err\");}\n",language:"javascript"}}]},{id:"RL68235348568040d4bda4a81492fce87f",name:"AUStudentStore",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"en-au/store/b/student",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// JavaScript source code section.m-multi-hero-item, div.m-channel-placement-item, section.m-content-placement-item,\nvar debug = 0, fireTags = 1;\nvar elements = \"section.m-multi-hero-item, div#coreui-feature-fuhlmyn section div a, a#coreui-highlightfeature-q04bez3-0, ul.c-group, section.m-content-placement-item\";\n\ntry {\n\t$(document).on('mousedown', elements, '', function () {\n\t\tif (debug) { console.log(\"Tag is running\") }\n\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tif (fireTags) {\n\t\t\tBootstrapper.imageRequest('https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand);\n\t\t\tBootstrapper.imageRequest('https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick');\n\t\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1268102&t=2\");\n\t\t}\n\n\n\t});\n} catch (clkerr) { console.log(\"au student store error\"); }",language:"javascript"}}]},{id:"RL683ad07cec0f4be5a6c44515d9d77917",name:"Media_/LL-LL/Surface- Configurations (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/p/surface-pro-x/",valueIsRegex:!0},{value:"/p/surface-laptop-go/",valueIsRegex:!0},{value:"/d/surface-pro-x/",valueIsRegex:!0},{value:"/d/surface-laptop-go/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//See all configurations button\n jQuery("[href*=\'/configure/Surface-Pro-X/8qg3bmrhnwhk\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n});\n  \njQuery("[href*=\'/configure/surface-laptop-go/94FC0BDGQ7WV\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n});  \n  \n//The Surface Book 3 Page is no longer required to be tagged as this element is duplicated in an already existing rule (SurfaceGrowthCPE)\n// jQuery("[href*=\'/configure/Surface-Book-3/8XBW9G3Z71F1\']").on("mousedown", function(){\n//var image = new Image(1, 1);\n//image.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n//});   \n    \n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Surface- Configurations");\n}\n',language:"javascript"}}]},{id:"RL6aa63bb8d47c4dd5b51460f0542eefe4",name:"GBLDL",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-80}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var _TMDL = {\n        busgrp: [],\n        cc: "Unknown",\n        isprod: false,\n        geo: "",\n        host: window.location.hostname.toLowerCase(),\n        itemprices: [],\n        lineItems: [],\n        ll: "other",\n        muid: "",\n        pagename: "other",\n        pageName: "other",\n        pageType: "other",\n        path: window.location.pathname.toLowerCase(),\n        pids: [],\n        pidsku: [],\n        pnames: [],\n        prdCt: [],\n        prdFam: [],\n        prdPrCat: [],\n        prdSecCat: [],\n        prdSubCat: [],\n        prdType: [],\n        pT: "",\n        purchaseID: "",\n        quantities: [],\n        reflc: "",\n        revsumdiv: [],\n        sales: [],\n        skus: [],\n        totamount: 0,\n        totAmountWTax: 0,\n        totqty: 0,\n\n        logRuleCall: function (r, d, i) {\n            if (typeof _TMutils === \'object\') {\n                _TMutils.logRuleCall(r, d, i);\n            } else {\n                try {\n                    _satellite.logger.error("error in logging and no _satellite obj");\n                } catch (_saterr) { }\n            }\n        },\n\n        getQSParam: function (arr, param2find) {\n            var n,\n                i = 0,\n                j = arr.length,\n                nvpair = [];\n\n            for (i = 0; i < j; i++) {\n                nvpair = arr[i].split("=");\n                if (nvpair[0].toLowerCase() == param2find.toLowerCase() && nvpair[1]) {\n                    return nvpair[1];\n                }\n            }\n            return "";\n        },\n\n        readCookie: function (name) {\n            var nameEQ = name + "=";\n            var ca = document.cookie.split(\';\');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == \' \') c = c.substring(1, c.length);\n                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);\n            }\n            return null;\n        },\n\n        createCookie: function (name, value, days) {\n            var expires = "";\n            var date;\n            var domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";\n            if (days) {\n                date = new Date();\n                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n                expires = "; expires=" + date.toGMTString();\n            }\n            document.cookie = name + "=" + value + expires + domainstr;\n        }\n    };\n\n    var qs = "",\n        qsdecoded = "",\n        qs2 = "",\n        qsarr = [],\n        jsonstr = "",\n        jsonobj = {},\n        jsonstr,\n        pt,\n        pc,\n        ptlower,\n        _pagetypemap = {}\n        ;\n\n    if (document.referrer) {\n        reflc = document.referrer.toLowerCase();\n    }\n\n    qs = (window.location.search) ? window.location.search : "";\n    if (qs.indexOf("?n=ensighten.html?") == 0) {\n        qs = qs.substring(17);\n    }\n\n    if (qs.indexOf("?") == 0) {\n        qs = qs.substring(1);\n    }\n\n    qs = qs.replace(/%20&%20/g, "%20%26%20");\n    qs = qs.replace(/ & /g, "%20%26%20");\n    qsarr = qs.split("&");\n\n    if (~window.location.host.indexOf("compass-ssl.xboxlive.com") || ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {\n        // top level params from iframe:  pN=cart&cl=en-US&market=US\n        _TMDL.purchaseID = _TMDL.getQSParam(qsarr, "orderId") || _TMDL.getQSParam(qsarr, "id");\n        _TMDL.muid = _TMDL.getQSParam(qsarr, "muid");\n        _TMDL.pageName = _TMDL.getQSParam(qsarr, "pN");\n        _TMDL.pageType = _TMDL.pageName;\n        _TMDL.geo = _TMDL.getQSParam(qsarr, "market");\n        _TMDL.ll = _TMDL.getQSParam(qsarr, "culture") || _TMDL.getQSParam(qsarr, "cl");\n        _TMDL.totamount = _TMDL.getQSParam(qsarr, "totAmtWoTx");\n        _TMDL.totAmountWTax = _TMDL.getQSParam(qsarr, "totAmt");\n        jsonstr = _TMDL.getQSParam(qsarr, "orderLineItems");\n\n        if (~reflc.indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta") < 0) { _TMDL.isprod = true; }\n\n        if (!jsonstr) {\n            _TMDL.logRuleCall("orderLineItems json missing");\n        } else {\n            try {\n                if (jsonstr.indexOf("[") > -1) {\n                    jsonstr = jsonstr.replace(/%22%20Dis/g, \'%20Dis\');\n                    jsonstr = jsonstr.replace(/portable%2013%22%20/g, \'portable%2013%20\');\n                    jsonstr = jsonstr.replace(/%22%204K/g, \'%204K\');\n                    jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, \'%22Samsung%2049%20\');\n                    jsonstr = jsonstr.replace(/%22%2F/g, \'%2F\');\n                    jsonstr = jsonstr.replace(/5%22%20%2F/g, \'5%2F\');\n                    jsonstr = jsonstr.replace(/%223%2F4%22%20/g, \'%223%2F4%20\');\n                    jsonstr = jsonstr.replace(/15.6%22%20/g, \'15.6%20\');\n                    jsonstr = jsonstr.replace(/%22/g, \'"\');\n                    _TMDL.lineItems = JSON.parse(jsonstr);\n                } else {\n                    jsonstr = jsonstr.replace(/%22%20Dis/g, \'%20Dis\');\n                    jsonstr = jsonstr.replace(/portable%2013%22%20/g, \'portable%2013%20\');\n                    jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, \'%22Samsung%2049%20\');\n                    jsonstr = jsonstr.replace(/%22%204K/g, \'%204K\');\n                    jsonstr = jsonstr.replace(/%22%2F/g, \'%2F\');\n                    jsonstr = jsonstr.replace(/5%22%20%2F/g, \'5%2F\');\n                    jsonstr = jsonstr.replace(/%223%2F4%22%20/g, \'%223%2F4%20\');\n                    jsonstr = jsonstr.replace(/15.6%22%20/g, \'15.6%20\');\n                    _TMDL.lineItems = JSON.parse(decodeURIComponent(jsonstr));\n                }\n            } catch (jsonparseerr) { _TMDL.logRuleCall("jsonparse error", "jsonparse error", window.location.search); _satellite.logger.error("jsonparse error"); }\n        }\n\n    } else if (typeof _pageBITags == "object") {\n        // consume _pageBITags object from the non-iframe pages (e.g. OneRF)\n        pt = _pageBITags.pageTags;\n        ptlower = pt.pageType.toLowerCase();\n        _TMDL.pageName = pt.pageName;\n        _TMDL.ll = pt.mkt;\n        _TMDL.lang = pt.mkt.split("-")[0];\n        _TMDL.geo = pt.mkt.split("-")[1];\n        _TMDL.pageType = pt.pageType;\n        if (~window.location.host.toLowerCase().indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta") < 0) { _TMDL.isprod = true; }\n\n        try {\n            _TMDL.muid = _TMDL.readCookie("MUID");\n        } catch (muiderr) { _TMDL.logRuleCall("muid err"); }\n\n        if (~ptlower.indexOf("category")) {\n\n            // CATEGORY PAGE\n\n            // https://onestore-ppe.microsoft.com/en-sg/store/b/surface?icid=CNavDevicesSurface&setswitch=optimizely_disabled%3A1%2Censighten_disabled%3D0\n\n        } else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && (typeof _pageBITags == "object" && typeof _pageBITags.pageContracts == "object" && typeof _pageBITags.pageContracts.ProductInfo == "object")) {\n            // PDP PAGE\n            pc = _pageBITags.pageContracts.ProductInfo;\n            _TMDL.pids.push(pc.id);\n            _TMDL.skus.push(pc.sku);\n            _TMDL.pidsku.push(pc.id + "-" + pc.sku);\n            _TMDL.prdCt.push(pc.prdCt);\n            _TMDL.prdPrCat.push(pc.priCat);\n            _TMDL.prdSecCat.push(pc.prdSecCat);\n            _TMDL.prdSubCat.push(pc.prdSubCat);\n            _TMDL.prdType.push(pc.family);\n            _TMDL.pnames.push(pc.title);\n            _TMDL.cc = pc.cur;\n            _TMDL.quantities.push(1);\n            _TMDL.sales.push(_pageBITags.pageContracts.ProductInfo.rtPrice);\n            _TMDL.quantities.push(1);\n            _TMDL.itemprices.push(_TMDL.sales[0]);\n        } else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && ~_TMDL.path.indexOf("/configure/")) {\n            ptlower = "configure";\n            _TMDL.pageType = "configure";\n        }\n    }\n\n    try {\n        // remap pagetypes\n        _pagetypemap = {\n            // old : new\n            "pdp": "detail",\n            "product details": "detail",\n            "sfw-pdp-pagetemplate": "detail",\n            "sfw-category-pagetemplate": "category",\n            "onestore-shoppingcart-template": "cart",\n            "congrats": "receipt"\n        };\n\n        if (_pagetypemap[_TMDL.pageType.toLowerCase()]) {\n            _TMDL.pageType = _pagetypemap[_TMDL.pageType.toLowerCase()];\n        }\n\n        _TMDL.pT = (_TMDL.pageType == "receipt") ? "rP" : _TMDL.pageType;\n\n        // added 7/12/18 due to Convergence making category pagetype less reliable\n\n        if (~window.location.pathname.indexOf("/b/") && window.location.pathname.indexOf("RETg7o") < 0) {\n            _TMDL.pageType = "category";\n        }\n\n    } catch (err) { _TMDL.logRuleCall("pageTypeMapError", _TMDL.pageType); }\n\n    //--------------------------------------------------------\n    // create backwards compatible arrays from orderLineItems\n    //--------------------------------------------------------\n\n    var temppname;\n    for (var i = 0; i < _TMDL.lineItems.length; i++) {\n        temppname = "";\n        _TMDL.pids.push((_TMDL.lineItems[i].pId) ? _TMDL.lineItems[i].pId : "");\n        _TMDL.skus.push((_TMDL.lineItems[i].sku) ? _TMDL.lineItems[i].sku : "");\n        try {\n            temppname = decodeURIComponent(_TMDL.lineItems[i].ti);\n        } catch (pnameerr) {\n            temppname = (_TMDL.lineItems[i].ti) ? _TMDL.lineItems[i].ti : "";\n        }\n        _TMDL.pnames.push(temppname);\n        _TMDL.sales.push((_TMDL.lineItems[i].tot && typeof _TMDL.lineItems[i].txA !== \'undefined\' && typeof _TMDL.lineItems[i].q !== \'undefined\') ? (_TMDL.lineItems[i].tot - (_TMDL.lineItems[i].q * _TMDL.lineItems[i].txA)) : _TMDL.lineItems[i].tot);\n        _TMDL.prdPrCat.push((_TMDL.lineItems[i].pC) ? _TMDL.lineItems[i].pC : "");\n        _TMDL.prdFam.push((_TMDL.lineItems[i].pF) ? _TMDL.lineItems[i].pF : "");\n        _TMDL.prdType.push((_TMDL.lineItems[i].pT) ? _TMDL.lineItems[i].pT : "");\n        _TMDL.pidsku.push(_TMDL.pids[i] + "-" + _TMDL.skus[i]);\n        _TMDL.quantities.push((_TMDL.lineItems[i].q) ? _TMDL.lineItems[i].q : 1);\n\n        if (_TMDL.lineItems[i].cur) {\n            _TMDL.cc = _TMDL.lineItems[i].cur;\n        }\n\n        _TMDL.totqty += _TMDL.quantities[i];\n        _TMDL.itemprices.push(_TMDL.sales[i] / _TMDL.quantities[i]);\n    }\n\n\n\n    var missingCCpagetype = "";\n    if (_TMDL.cc == "Unknown" && ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {\n        missingCCpagetype = (~window.location.href.indexOf("pN=congrats")) ? "receipt" : "cart";\n        if (missingCCpagetype == "receipt") { _TMDL.logRuleCall("missingCC" + missingCCpagetype + "_" + _TMDL.geo, "missingCC" + "_" + _TMDL.geo, window.location.search); }\n    }\n\n    var ccmap = {\n        \'US\': \'USD\',\n        \'AU\': \'AUD\',\n        \'BR\': \'BRL\',\n        \'CA\': \'CAD\',\n        \'CH\': \'CHF\',\n        \'DK\': \'DKK\',\n        \'GB\': \'GBP\',\n        \'JP\': \'JPY\',\n        \'MX\': \'MXN\',\n        \'NO\': \'NOK\',\n        \'RU\': \'RUB\',\n        \'SE\': \'SEK\',\n        \'AT\': \'EUR\',\n        \'BE\': \'EUR\',\n        \'CY\': \'EUR\',\n        \'DE\': \'EUR\',\n        \'ES\': \'EUR\',\n        \'FI\': \'EUR\',\n        \'FR\': \'EUR\',\n        \'GR\': \'EUR\',\n        \'IR\': \'EUR\',\n        \'IT\': \'EUR\',\n        \'LU\': \'EUR\',\n        \'NL\': \'EUR\',\n        \'PT\': \'EUR\',\n        \'NEVERHIT\': \'Unknown\'\n    };\n\n    if (_TMDL.cc == "Unknown" || _TMDL.cc == "") {\n        try {\n            if (ccmap[_TMDL.geo.toUpperCase()]) {\n                _TMDL.cc = ccmap[_TMDL.geo.toUpperCase()];\n            }\n        } catch (ccerr) { }\n    }\n\n    if (_TMDL.cc == "Unknown" && (window.location.href.indexOf(\'"EUR"\') > -1 || window.location.href.indexOf("%22EUR%22") > -1)) {\n        _TMDL.cc = "EUR";\n    }\n\n    _TMDL.pagename = _TMDL.pageName; // backwards compatibility for some tags\n    // make global for access in other tags\n    window._TMDL = window._TMDL || _TMDL;\n\n}\n\ncatch (err) { console.log("DataLayer: " + err.message); }',language:"javascript"}}]},{id:"RL7d79c8419a9a418b8b1c73ae64a0c9e1",name:"DIGSHELL",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:45}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"\\/p\\/",valueIsRegex:!0},{value:"\\/d\\/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\twindow.shell_Tracking = {\n\n\t\t_init: function () {\n\t\t\tshell_Tracking.hostname = window.location.hostname.replace(/\\.microsoft\\.com$/i, \'\');\n\t\t\tshell_Tracking.URI = window.location.pathname.toString();\n\t\t\t//setup page path dimensions\n\t\t\tshell_Tracking._getPath();\n\t\t},\n\n\t\t_getIsProd: function () {\n\t\t\tvar env = \'test\';\n\t\t\tif (shell_Tracking.hostname.match(/\\./g)) {\n\t\t\t\tenv = \'test\';\n\t\t\t\tshell_Tracking.env = \'test\';\n\t\t\t} else if (window.location.hostname.match(/\\.microsoft\\.com$/i)) {\n\t\t\t\tenv = \'\';\n\t\t\t\tshell_Tracking.env = \'prod\';\n\t\t\t\tshell_Tracking.hostname = \'onestore\';\n\t\t\t}\n\t\t\treturn env;\n\t\t},\n\n\t\t_getLocale: function () {\n\t\t\tshell_Tracking.locale = shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, \'$1\');\n\t\t\tvar locale = shell_Tracking.locale.replace(/\\-/ig, \'\').replace(/\\//ig, \'\').toLowerCase();\n\t\t\treturn locale;\n\t\t},\n\n\t\t_removeLocale: function () {\n\t\t\tvar path = shell_Tracking.URI.replace(/^\\/..\\-..\\/?(.*)/i, \'$1\').toLowerCase();\n\t\t\treturn path;\n\t\t},\n\n\t\t_getPath: function () {\n\t\t\tvar path = shell_Tracking._removeLocale();\n\t\t\tpath = path.replace(/\\/$/, \'\').replace(/^\\//, \'\');\n\t\t\tshell_Tracking.path = path;\n\t\t},\n\n\t\t_onBeforePageView: function () {\n\t\t\t/*\n\t\t\tvar authCookie = shell_Tracking._getCookie(\'StoreMsaUser\');\n\t\t\tif (authCookie) {\n\t\t\t\tshell_Tracking.auth = \'y\';\n\t\t\t} else {\n\t\t\t\tshell_Tracking.auth = \'n\';\n\t\t\t}\n\t\t\t*/\n\t\t},\n\n\t\t_getCookie: function (name) {\n\t\t\tvar nameEQ = name + "=";\n\t\t\tvar ca = document.cookie.split(\';\');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == \' \') { c = c.substring(1, c.length); }\n\t\t\t\tif (c.indexOf(nameEQ) == 0) { return unescape(c.substring(nameEQ.length, c.length)); }\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\t_getMetaValue: function(name) {\n\t\t\treturn $(\'meta[name="\' + name + \'"]\').attr(\'content\');\n\t\t},\n\n\t\t_recordXboxDigitalPurchase: function (data) {\n\t\t\tvar worksonxbox = ((shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox") && shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox")!==\'false\') || (window.location.pathname.indexOf("xbox") > -1)) ? true : false;\n\t\t\tvar pass_type = shell_Tracking._getMetaValue("ms\\\\.prod_pass_type");\n\t\t\tvar productFamily = shell_Tracking._getMetaValue("ms\\\\.prod_family");\n\t\t\tvar lcpath = window.location.pathname.toLowerCase();\n\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   \n\t\t\t// original floodlight\n\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=6952136;type=store00;cat=store00");  // added 6/26/17 -- keep as the generic version\n\n\t\t\t\n\t\t\t//xbox live gold : \n\t\t\t\t// \tCFQ7TTC0K5ZM -- physical\n\t\t\t\t// \tcfq7ttc0k5dj -- digital\n\t\t\t\t//   /src=8391497;type=xlg_sale;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t// games and gamepass:  //src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\n\n\n\t\t\tif (~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k5zm") || ~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k5dj")) {\n\t\t\t\t// XboxLiveGold_GBL_PchComplete_Transaction_DigitalStore:  src=8391497;type=xlg_sale;cat=pch_dgtl\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8391497;type=xlg_sale;cat=pch_dgtl");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId);\n\t\t\t\t\t\tBootstrapper.imageRequest((_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId).replace("464550763913771","1770559986549030"));\t\t\t\t\t\t\t\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else if (~lcpath.indexOf("cfq7ttc0k6l8") || ~lcpath.indexOf("cfq7ttc0kgq8") ||~lcpath.indexOf("cfq7ttc0khs0") || (productFamily && productFamily.toLowerCase() == \'passes\' && pass_type && pass_type.toLowerCase() == \'xbox\') || (productFamily.toLowerCase() == \'games\' && (worksonxbox || ~lcpath.indexOf("xbox") ) )) {\n\t\t\t\t//XboxGamePassGames_GBL_PchComplete_Transaction_DigitalStore\t/src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406391;type=xgpg_sls;cat=pch_dgtl");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId);\n\t\t\t\t\t\tBootstrapper.imageRequest((_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId).replace("464550763913771","1770559986549030"));\t\t\t\t\t\t\t\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:  src=8406157;type=stot_sl;cat=pch_dgtl\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:   src=8406727;type=wsft_sls;cat=pch_dgtl;  (CORRECT ONE)\n\t\t\t\t//Store-Other_GBL_PchComplete_Transaction_DigitalStore:  src=8406391;type=xgpg;cat=pdv_dgtl\n\t\t\t\t\n\t\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406391;type=xgpg;cat=pdv_dgtl");\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406727;type=wsft_sls;cat=pch_dgtl;");\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (typeof _TMDL.convcallbacks!==\'undefined\') {\n\t\t\t\t\tfor (var i=0; i< _TMDL.convcallbacks.length; i++) {\n\t\t\t\t\t\t_TMDL.convcallbacks[i](data,price,tax,data.orderId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch(callbackerr) {}\n\t\t\t\n\t\t},\n\t\t_dispatchDCMpurchase: function(worksonxbox,pass_type,productFamily,data,floodlightparams) {\n\t\t\t// added 6/26/17 -- this will be the older tag from before the DCM restructure\n\t\t\tvar a = "" + parseInt(1E5 * 1E4 * Math.random() * Math.random(),10)+ parseInt((Math.random() * 100000000),10);\n\t\t\t//var shell_locale = shell_Tracking.locale || shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, \'$1\');\n\t\t\t//var geo = shell_locale.split("-")[1];\n\t\t   //var locale = shell_locale.replace(/\\-/ig, \'\').replace(/\\//ig, \'\').toLowerCase();\n\t\t   var title = data.lineItems[0].title;\n\t\t   var productType = data.lineItems[0].productType;\n\t\t   var productId = data.lineItems[0].productId;\n\t\t   var availabilityId = data.lineItems[0].availabilityId;\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   var currencyCode = data.lineItems[0].currencyCode;\n\t\t   //var paymentTypeEvent = \'\';\n\t\t\tvar url = "https://ad.doubleclick.net/ddm/activity/"+floodlightparams+";qty=1;cost="+price+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t +";u25="+productId\n\t\t\t +";u26="+encodeURIComponent(title)\n\t\t\t +";u30="+productType\n\t\t\t +";u31="+currencyCode\n\t\t\t +";u32="+productId\n\t\t\t +";u33="+productId\n\t\t\t +";u34="+data.orderId\n\t\t\t //+";u35="+_TMDL.totqty\n\t\t\t +";u35=1"\n\t\t\t +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+data.orderId;\n\n\t\t var px = new Image(1, 1);\n\t\t px.src = url;\n\t  },\n\t\t\n\t\t_dispatchGamePassGamesRT: function () {\n\t\t\tvar url = "https://www.facebook.com/tr?id=1218689904914212&ev=PageView&noscript=1";\n\t\t\tvar px = new Image(1, 1);\n\t\t\tpx.src = url;\n\t\t\tBootstrapper.imageRequest("https://googleads.g.doubleclick.net/pagead/viewthroughconversion/968413686/?value=0&guid=ON&script=0");\n\t\t\tBootstrapper.imageRequest("https://bat.bing.com/action/0?ti=4000034&Ver=2");\n\t\t},\n\n\t};\n\t\n\tvar url="";\n\tvar worksonxbox = shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox")=="true" || (window.location.pathname.toLowerCase().indexOf("xbox") > -1) || (typeof _TMDL.pnames[0] !== \'undefined\' && _TMDL.pnames[0].toLowerCase().indexOf("xbox")>-1);\n\tvar type = $(\'meta[name="ms\\\\.prod_type"]\').attr(\'content\') || \'\';\n\tvar pass_type = $(\'meta[name="ms\\\\.prod_pass_type"]\').attr(\'content\') || \'\';\n\tif (worksonxbox && type && (type.toLowerCase() == \'games\' || type.toLowerCase() == \'addons\') || (window.location.pathname.match(/\\/xbox$/i)) || (pass_type && pass_type.toLowerCase() == \'xbox\')) {\n\n\t\tshell_Tracking._init();\n\n\t\trequire([\'jquery\'], function ($) {\n\t\t\t$(\'document\').ready(function () {\n\t\t\t\ttry {\n\t\t\t\t\t//shell_Tracking._onBeforePageView();\n\t\t\t\t\t//shell_Tracking._recordOmniturePageView();\n\t\t\t\t\t//shell_Tracking._initClickTracking();\n\t\t\t\t} catch (ex) { }\n\t\t\t});\n\t\t});\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error("DIGSHELL");\t\n}\n\n',language:"javascript"}}]},{id:"RL804049235a48433cb1e82263436fba08",name:"ADOBEDCORTG",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*  Adobe DCO Retargeting tag\n*/\n\ntry {\n\t// landing pages\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u="";\n\tvar lang = (_TMDL.ll.indexOf("-")>-1) ? _TMDL.ll.split("-")[0].toLowerCase() : "";\n\tvar utstring = "&ut1="+_TMDL.pidsku.join("%2C")+"&ut2="+lang+"&ut3="+_TMDL.geo.toLowerCase()+"&cachebuster="+rand;\n\n\tif (_TMDL.pT.indexOf("cart")<0 && _TMDL.pageType!==\'rP\' ) {\n\t\t// landing pages\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20114&ActionName=Microsoft_Store_RT_Pixel"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n\n\tif (~_TMDL.pT.indexOf("rP") && _TMDL.isprod) {\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50081&ActionName=Microsoft_Store_Conv_Pixel&Revenue="+_TMDL.totamount+"&TransactionID="+_TMDL.purchaseID+"&Currency="+_TMDL.cc+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t} else if (~_TMDL.pageType.toLowerCase().indexOf("cart") && _TMDL.isprod) {\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20132&ActionName=Microsoft_Store_Cart_Abandoner"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n} catch(err){\n\tif (_satellite) {\n\t  _satellite.logger.error("Adobe DCO Retargeting Error");\n\t  if (_TMutils){_TMutils.logRuleCall("Adobe DCO Retargeting",err.message,u);}\n\t} \n}\n',language:"javascript"}}]},{id:"RL81d828f12cec453ba0309f909a2aaf39",name:"Media_/EN-US/d/surface Twitter (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{
value:"/en-us/d/surface",valueIsRegex:!0},{value:"/en-us/d/surface/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  \n  //Page Load\n  var image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  var image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n\n  \n   //Configure Now button\njQuery("a:contains(\'Configure now\'),button:contains(\'Configure now\')").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9u&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);  \n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n  \n   //Surface Laptop Go for Business Button\njQuery("[href=\'https://www.microsoft.com/en-us/p/surface-laptop-go-for-business/8NR6D2WCLC72?icid=PDP_LaptopGo_forbusiness_C97_060421\']").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-US/d/surface Twitter (AEM/RT)");\n}',language:"javascript"}}]},{id:"RL9092ef86ecbc48cebb72d1cd61b6a4f1",name:"Media.SurfaceDuo_CPE (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/surface/devices/surface-duo"},{value:"/en-us/surface/devices/surface-duo/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//Note - This page belongs with the Surface property. Rule likely can be removed.\n  \n// ADNXS\n   //Main & Sticky Header\n  jQuery("a:contains(\'SHOP NOW\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Bottom of page - Removing as this is no longer on page\n /*\njQuery("a.c-call-to-action.c-glyph:eq(17)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n*/\n  \n\n//DoubleClick\n  //Main & Sticky Header\n jQuery("a:contains(\'SHOP NOW\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=PRE-ORDER"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=;gdpr_consent=${gdpr_consent_755};ord=1?";\n});\n  \n   \n //Bottom of page  Removing as this is no longer on page\n /*\njQuery("a.c-call-to-action.c-glyph:lt(17)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=PRE-ORDER"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=;gdpr_consent=${gdpr_consent_755};ord=1?";\n});\n*/\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.SurfaceDuo_CPE (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RL91844b25cd33488cbc0a6c7b7e79f429",name:"SundaySkySurface",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-us|en-ca|fr-ca|en-au)/.*surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2025-07-31T00:00:00Z",start:"2023-03-20T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!1,source:'var firstConfig = \'[data-automation-test-id*="next-button"]\';\nvar secondConfig = \'[data-automation-test-id*="checkout-button"]\';\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        const rand5 = parseInt(Math.random() * 10000000000000);\n        const rand6 = parseInt(Math.random() * 10000000000000);\n        const rand7 = parseInt(Math.random() * 10000000000000);\n        const rand8 = parseInt(Math.random() * 10000000000000);\n\n        var image = new Image(1, 1);\n        image.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=" + _TMDL.host + _TMDL.path + "&cb=" + rand5 + "&m=atc&udt[segment]=[visitor,atc]&udt[userid]=[USER_ID]&udt[sku]=" + _TMDL.pids.map(x => x.toUpperCase()) + "&udt[cat]=" + _TMDL.pnames + "&udt[ptype]=" + _TMDL.pageType + "&udt[bu]=[surface]&udt[country]=" + _TMDL.geo + "&udt[language]=" + _TMDL.lang;\n\n        var image2 = new Image(1, 1);\n        image2.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand6 + "&s=1";\n\n        var image3 = new Image(1, 1);\n        image3.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand7 + "&s=2";\n\n        var image4 = new Image(1, 1);\n        image4.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand8 + "&s=3";\n    });\n}\n\ntry {\n    const rand1 = parseInt(Math.random() * 10000000000000);\n    const rand2 = parseInt(Math.random() * 10000000000000);\n    const rand3 = parseInt(Math.random() * 10000000000000);\n    const rand4 = parseInt(Math.random() * 10000000000000);\n    const pids = _TMDL.path.includes("configure") ? [].concat(_TMDL.pageName.toUpperCase()) : _TMDL.pids.map(x => x.toUpperCase());\n\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=" + _TMDL.host + _TMDL.path + "&cb=" + rand1 + "&m=uui&udt[segment]=[visitor]&udt[userid]=[USER_ID]&udt[sku]=" + pids + "&udt[cat]=" + _TMDL.pnames + "&udt[bu]=[surface]&udt[country]=" + _TMDL.geo + "&udt[language]=" + _TMDL.lang;\n\n    var image2 = new Image(1, 1);\n    image2.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand2 + "&s=1";\n\n    var image3 = new Image(1, 1);\n    image3.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand3 + "&s=2";\n\n    var image4 = new Image(1, 1);\n    image4.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand4 + "&s=3";\n\n    attachPixels(firstConfig);\n    attachPixels(secondConfig);\n    \n}\ncatch (err) {\n    console.log("Sunday Sky Category/PDP/Config");\n}',language:"javascript"}}]},{id:"RL9287f2337be44c2fba49bde96a312917",name:"GOOGRTG",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar totamount = 0,\n\t  totvalstring = "",\n\t  googpagetype = "other",\n\t  prodstring = "",\n\t  img="";\n\tvar pagetypemap = {\n\t  "home": "home",\n\t  "search": "searchresults",\n\t  "detail": "product",\n\t  "category": "category",\n\t  "checkout_shopping_cart": "cart",\n\t  "cart": "cart",\n\t  "list": "category",\n\t  "receipt": "purchase"\n\t};\n\n\ttry {\n\t  if (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()];\n\t  }\n\t  for (var i = 0; i < _TMDL.pids.length; i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t  totamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t  }\n\t} catch (e) {}\n\n\tif (_TMDL.pidsku.length) {\n\t  prodstring = "%3Becomm_prodid%3D" + _TMDL.pidsku.join("%2C"); \n\t}\n\n\tif (totamount > 0) {\n\t  totvalstring = "%3Becomm_totalvalue%3D" + totamount;\n\t}\n\n\timg = "//googleads.g.doubleclick.net/pagead/viewthroughconversion/923371515/?guid=ON&script=0&url=" + encodeURIComponent(window.location.hostname + window.location.pathname) + "&data=ecomm_pagetype%3D" + googpagetype + prodstring + totvalstring;\n\n\tvar c=new Image(0,0);\n\tc.src=img;\n}\ncatch(err)\n{\n\t_satellite.logger.error("GOOGRTG");\t\n}\n',language:"javascript"}}]},{id:"RL9db76557933946afb2f25ace5add098c",name:"BoostHomepage",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"https://www.microsoft.com/en-us"==window.location.href||"https://www.microsoft.com/en-us/"==window.location.href}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"var firstConfig = '[data-automation-test-id*=\"HighlightCarouselInnerSectionListItem\"]';\n\ntry {\n    attachPixels(firstConfig);\n} catch (e) {\n    console.log(\"Boost Homepage has failed\");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        window.boost = window.boost || [];\n        window.boost.push('event', 'click', { 'event_label': _TMDL.pageName });\n    });\n}",language:"javascript"}}]},{id:"RLa7f4e9bd070e4fedb22dccc5fbfd1f05",name:"DCM.HomeBar",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/sale"},{value:"/en-us/store/b/sale/"},{value:"/fr-ca/store/b/sale/"},{value:"/fr-ca/store/b/sale/"},{value:"/en-ca/store/b/sale"},{value:"/en-ca/store/b/sale/"},{value:"/en-gb/store/b/student"},{value:"/en-gb/store/b/student/"},{value:"/fr-fr/store/b/student"},{value:"/fr-fr/store/b/student/"},{value:"/de-de/store/b/student"},{value:"/de-de/store/b/student/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\njQuery("#uhf-g-nav").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Homebar Options "+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n\t});\n} \ncatch(err) {\n\t_satellite.logger.error("DCM.Homebar");\n}',language:"javascript"}}]},{id:"RLa95c5c1f9ffa4ad69c72b6459e7ef0bc",name:"AU/ConsumerConsultationTag",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/online-computer-shopping-appointments",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\ntry {\n    //Floodlight pv\n    var image = new Image(1, 1);\n    image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n    // Yahoo pv\n    var image = new Image(1, 1);\n    image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUSLandingPageVisit";\n\n    // training - training\n    $(\'a[href*="https://digitalreservations.microsoft.com/en-au/appointment/create"]\').on("mousedown", function () {\n        var cN = $(this).attr("data-bi-cn");\n        \n        var image = new Image(1, 1);\n        image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=" + cN + ";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n        //Yahoo clk\n        image2 = new Image(1, 1);\n        image2.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUSbuttonclick";\n    });\n\n}\ncatch (err) {\n    _satellite.logger.error("AU/ConsumerConsultationTag");\n}',language:"javascript"}}]},{id:"RLab2298c7467f48a6ad45da5d885a3a2d",name:"AUSurfSMB",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/p/surface-pro-6-for-business-choice-of-accessory/8p88kcx6r5s7")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/d/surface-pro-6-for-business-choice-of-accessory/8p88kcx6r5s7")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/p/surface-book-2-for-business-choice-of-accessory/8pcw0wkflz2x")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/d/surface-book-2-for-business-choice-of-accessory/8pcw0wkflz2x")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/store/b/business")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*  AU Surface SMB \n\nCampaign:  AU Surface SMB\nContact: Lauren Ward @ Carat\nTags:  Outbrain, DV360\n*/\n\n// Landing Page Tags\n\n// DV360 Activity Name: Microsoft_LP_landing page\nvar\ta = "" + (Math.random() * 10000000000000);\nBootstrapper.imageRequest(\'https://ad.doubleclick.net/ddm/activity/src=6487971;type=invmedia;cat=micro00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=\' + a + \'?\');\n// Appnexus Microsoft_LP_landing page\nBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1120808&seg=18111539&t=2");\n\n\n$(document).on(\'mousedown\',\'button[id*="buttons_BuildABundleButton"]\',\'\', function() {\n\t// Outbrain\n\tBootstrapper.imageRequest("https://tr.outbrain.com/pixel?marketerId=00fbc5a6837b6c040daa1e33bdf0cadcaa&name=lead");\n\t// DV360 Activity Name:  Microsoft_Int_button click\n\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=6487971;type=invmedia;cat=micro000;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?");\n\t// Appnexus Microsoft_Int_button click\n\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1120809&seg=18111541&t=2");\n});\n',language:"javascript"}}]},{id:"RLab4fd1d7566a4c858a54b382ad0c6b73",name:"BingSurfClkCustom (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:80}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.pathname.toLowerCase().indexOf("/d/")&&~window.location.pathname.toLowerCase().indexOf("surface")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/*\n\nRule: BingSurfClkCustom\n\nreturn (~window.location.pathname.toLowerCase().indexOf(\"/p/\") && ~window.location.pathname.toLowerCase().indexOf(\"surface\")\t)\n\n*/\n\nvar tempobj; \n\ntry {\n\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\")<0 && (typeof uetq=='object')) {\n\n\t\ttempobj={};\n\t\t\n\t\tif (_TMDL.pidsku.length > 0) {\n\t\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\t\ttempobj.ecomm_pagetype = \"product\";\n\t\t\ttempobj.items = [\n\t\t\t\t{\n\t\t\t\t  'id': _TMDL.pidsku[0],\n\t\t\t\t  'category': 'surface',\n\t\t\t\t  'price' : _TMDL.sales[0]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\t\n\t\t// Configure Now CTA\n        /*\n\t\t$(document).on('mousedown','button[id*=\"ConfigureDeviceButton\"]','', function() {\n\t\t\twindow.uetq.push('event','configurenow', tempobj); \n\t\t});\n        */\n      \n\t\t// Configure Now CTA - Updated 7/19 to correct ID\n        jQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\n            window.uetq.push('event','configurenow', tempobj); \n         });\n      \n\t\t// BuildYourBundle CTA\n        $(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]','', function() {\n\t\t\twindow.uetq.push('event','buildyourbundle', tempobj); \n\t\t});\n\t\t\t\n\t\t\n\t\t// check your eligibility CTA\n\t\t\n\t\t$(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n\t\t\twindow.uetq.push('event','checkeligibility', tempobj); \n\t\t});\n      \n      \t// Add to Cart button, particularly needed for Surface Go PDP\n\t\t$(document).on('mousedown','button[id*=\"buttons_AddToCartButton\"]','', function() {\n\t\t\twindow.uetq.push('event','addtocartbutton', tempobj); \n\t\t});\t\t\n\t}\n} catch(bingerr) {console.log(\"bing onclick err\");}\n",language:"javascript"}}]},{id:"RLae08a96c63704f75b6eec5b2f84236e6",name:"AUSurfaceCommercial/SurfacePDPs",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/pathAndQuerystring.js",settings:{paths:[{value:"/en-au/store/b/surfaceforbusiness\\?icid=Paid_Media_Surface_Business_Black_Friday_en_AU",valueIsRegex:!0},{value:"/en-au/d/surface-pro-10-for-business/(8V73D6QWRSS1|8v73d6qwrss1)\\?icid=Paid_Media_SP10_Busines_Black_Friday_en_AU",valueIsRegex:!0},{value:"/en-au/d/surface-laptop-6-for-business/(8pz3fvs57qcv|8PZ3FVS57QCV)\\?icid=Paid_Media_SL6_Busines_Black_Friday_en_AU",valueIsRegex:!0},{value:"/en-au/store/configure/surface-laptop-6-for-business/8pz3fvs57qcv",valueIsRegex:!0},{value:"/en-au/store/configure/surface-pro-10-for-business/8v73d6qwrss1",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2025-01-16T00:00:00Z",start:"2024-11-24T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var path = _TMDL.path;\n    var pageLoadid = "";\n\n    if (path == \'/en-au/store/b/surfaceforbusiness\') {\n        pageLoadid = "1833818";\n    } else if (path == \'/en-au/d/surface-pro-10-for-business/8v73d6qwrss1\') {\n        pageLoadid = "1833819";\n        attachPixels(\'a[href*="/store/configure"]\', "1833821");\n    } else if (path == \'/en-au/d/surface-laptop-6-for-business/8pz3fvs57qcv\') {\n        pageLoadid = "1833820";\n        attachPixels(\'a[href*="/store/configure"]\', "1833822");\n    } else if (path == \'/en-au/store/configure/surface-laptop-6-for-business/8pz3fvs57qcv\') {\n        pageLoadid = "1833826";\n        attachPixels(\'button[data-automation-test-id*="configuratorV3-BottomBar-button"]\', "1833829");\n    } else if (path == \'/en-au/store/configure/surface-pro-10-for-business/8v73d6qwrss1\') {\n        pageLoadid = "1833827";\n        attachPixels(\'button[data-automation-test-id*="configuratorV3-BottomBar-button"]\', "1833828");\n    }\n\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "https://secure.adnxs.com/px?id=" + pageLoadid + "&t=2";\n} catch (e) {\n    console.log("Rule has failed");\n}\n\nfunction attachPixels(elementAddress, clickId) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var click = new Image(1, 1);\n        click.src = "https://secure.adnxs.com/px?id=" + clickId + "&t=2";\n    });\n}',language:"javascript"}}]},{id:"RLafca8ec24b594c8e8d900f5fd9373a36",name:"VRZN_LP_Srfc",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/en-us/d/surface.*",valueIsRegex:!0},{value:"^/en-ca/d/surface.*",valueIsRegex:!0},{value:"^/de-de/d/surface.*",valueIsRegex:!0},{value:"^/fr-fr/d/surface.*",valueIsRegex:!0},{value:"^/en-gb/d/surface.*",valueIsRegex:!0},{value:"^/en-au/d/surface.*",valueIsRegex:!0},{value:"^/jp-jp/d/surface.*",valueIsRegex:!0},{value:"^/en-ca/d/surface.*",valueIsRegex:!0},{value:"^/fr-ca/d/surface.*",valueIsRegex:!0},{value:"^/en-sg/d/surface.*",valueIsRegex:!0},{value:"^/nl-nl/d/surface.*",valueIsRegex:!0},{value:"^/sv-se/d/surface.*",valueIsRegex:!0},{value:"^/nb-no/d/surface.*",valueIsRegex:!0},{value:"^/da-dk/d/surface.*",valueIsRegex:!0},{value:"^/en-ie/d/surface.*",valueIsRegex:!0},{value:"^/es-es/d/surface.*",valueIsRegex:!0},{value:"^/de-ch/d/surface.*",valueIsRegex:!0},{value:"^/fr-ch/d/surface.*",valueIsRegex:!0},{value:"^/(d|p)/surface.*",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  var image = new Image(1,1);\n  image.src = "//sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=ViewProduct&product_id=" + _pageBITags.pageContracts.ProductInfo.id + "-" + _pageBITags.pageContracts.ProductInfo.sku;\n}\ncatch(err)\n{\n\t_satellite.logger.error("Verizon_LP");\n}',language:"javascript"}}]},{id:"RLb84483393e0944389f21094936208317",name:"Media_/ja-jpr/store/b/sale",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/ja-jp/store/b/sale"},{value:"/ja-jp/store/b/sale/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n// ADNXS\n \n //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n\n\n//DoubleClick\n \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Now"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Product Options"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  \n//Yahoo\n \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/ja-jp/store/b/sale");\n}\n  ',language:"javascript"}}]},{id:"RLb8a0705083774061918b4e02a68b2502",name:"Surface_XANDR /d/ LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface-laptop-for-business-copilot-pc-intel/93dzmw6q4w2b",valueIsRegex:!0},{value:"/en-us/d/surface-pro-for-business-copilot-pc-intel/8qfmn9xp1rl9",valueIsRegex:!0},{value:"/en-us/store/b/surfaceforbusiness",valueIsRegex:!0},{value:"/en-au/d/surface-laptop-for-business-copilot-pc-intel/93dzmw6q4w2b",valueIsRegex:!0},{value:"/en-au/d/surface-pro-for-business-copilot-pc-intel/8qfmn9xp1rl9",valueIsRegex:!0},{value:"/en-au/store/b/surfaceforbusiness",valueIsRegex:!0},{value:"/ja-jp/d/surface-laptop-for-business-copilot-pc-intel/93dzmw6q4w2b",valueIsRegex:!0},{value:"/jp-jp/d/surface-pro-for-business-copilot-pc-intel/8qfmn9xp1rl9",valueIsRegex:!0},{value:"/ja-jp/store/b/surfaceforbusiness",valueIsRegex:!0},{value:"/en-us/surface/devices/surface-laptop-7th-edition",valueIsRegex:!0},{value:"/en-us/surface/devices/surface-pro-11th-edition",valueIsRegex:!0},{value:"/en-us/surface",valueIsRegex:!0},{value:"/en-gb/surface/devices/surface-laptop-7th-edition",valueIsRegex:!0},{value:"/en-gb/surface/devices/surface-pro-11th-edition",valueIsRegex:!0},{value:"/en-gb/surface",valueIsRegex:!0},{value:"/en-au/surface/devices/surface-laptop-7th-edition",valueIsRegex:!0},{value:"/en-au/surface/devices/surface-pro-11th-edition",valueIsRegex:!0},{value:"/en-au/surface",valueIsRegex:!0},{value:"/ja-jp/surface/devices/surface-laptop-7th-edition",valueIsRegex:!0},{value:"/ja-jp/surface/devices/surface-pro-11th-edition",valueIsRegex:!0},{value:"/JA-JP/surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nif (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/d/")) {\n\tif (~window.location.pathname.toLowerCase().indexOf("/en-us/d/surface-go/8v9dp4lnknsz")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182093&seg=19686450&t=2");\t\n\t} else if (~window.location.pathname.toLowerCase().indexOf("/en-us/d/surface-book-2/8mcpzjjcc98c")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182149&seg=19686725&t=2");\t\t\n\t} \t\n}\n*/\n\n(function() {\n\ttry {\n\t\tvar imgurl="",consent = 0; \n        //----- CPRA: Condition check if user chooses to opt out or opt in ------//\n        // Global CPRA variable -- gpc3PFlag           \n        if (typeof(GPC_DataSharingOptIn) !== "undefined" && !GPC_DataSharingOptIn){ \n        consent = 0;\n        } else {\n        consent = 1; \n        }\n\t\n\t\t\timgurl = "https://secure.adnxs.com/pixie?pi="+1182093+"&e=PageView&script=0&consent="+consent;\n\t\t\tBootstrapper.imageRequest(imgurl);\n\t\t\n\t} catch(e) { _satellite.logger.log("warn: "+e);\t}\n})();',language:"javascript"}}]},{id:"RLb9638e6a11854c11b48d315d3f8fc064",name:"Media.ja-jp.store.b.surface-studentdeals",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/ja-jp/store/b/surface-studentdeals"},{value:"/ja-jp/store/b/surface-studentdeals/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\ntry {\n    //ADNXS\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n\n    //DCM\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=Check Eligibility Student" + ";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?";\n    });\n\n    //Yahoo\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n    });\n\n    //Adobe DCO\n    var rand = parseInt(Math.random() * 10000000000000);\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=" + rand;\n    });\n\n}\ncatch (err) { satellite.logger.error("Media.ja-jp.store.b.surface-studentdeals"); }\n\n',language:"javascript"}}]},{id:"RLbabdaaa9429a4087b3d39b2cae35a0ff",name:"Media.Verizon.Surface_081620 (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(/en-ca|/en-au|/en-gb|/fr-fr|fr-ca)\\/p\\/surface",valueIsRegex:!0},{value:"(/en-ca|/en-au|/en-gb|/fr-fr|fr-ca)\\/d\\/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n//Yahoo\n   //Shop now \njQuery("#PromotionBar a").on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n //Get started\njQuery("#purchaseColumn a").on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n //Configure now & Sticky\njQuery(\'button[id*="ConfigureDeviceButton"]\').on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.Verizon.Surface_081620(RT)");\n}\n',language:"javascript"}}]},{id:"RLbce7faddd577453299ebe0a2cad2a168",name:"Media.Verizon.Surface_081620 (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(/en-us)\\/p\\/surface",valueIsRegex:!0},{value:"(/en-us)\\/d\\/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n // Promo Bar\n  \njQuery("a:contains(\'Book your online appointment\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a:contains(\'Build your bundle\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a:contains(\'Learn more about promise\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a[href*=\'/en-us/p/surface\']").filter(\'a:contains("BUSINESS")\')\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n \n //Configure now & Sticky\njQuery("a:contains(\'Configure now\'),button:contains(\'Configure now\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.Verizon.Surface_081620 (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RLc26ce7186e9b40ebb1f276401c30be3b",name:"FBLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:40}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{
domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar marketMap = {\n\t\t"AT": "562684790554330",  \n\t\t"AU": "284489665351238", // iProspect\n\t\t"BE": "1441341485948213", // iProspect  (FR) \n\t\t"BR": "1351385668312384", // iProspect\n\t\t"CA": "822106911286239", // iProspect\n\t\t"CH": "1701617263415580",   \n\t\t"CN": "1675926909345981", \n\t\t"DE": "108292966463738",  // iProspect\n\t\t"DK": "254705608267657",  // iProspect\n\t\t"ES": "1626525834066953",  // iProspect\n\t\t"FI": "1719588481615214", \n\t\t"FR": "824192544408978", // iProspect\n\t\t"GB": "120587825211084", // iProspect\n\t\t"HK": "539267979583843", \n\t\t"IE": "249404655562787", // IProspect (added 9/13/17)\n\t\t"IN": "1974106256199230",  // (EN) iProspect\n\t\t"IR": "172987109739933",  \n\t\t"IT": "1598310580201695",  // iProspect\n\t\t"JP": "288860468248601", // iProspect\n\t\t"KR": "1413279412072377", // iProspect\n\t\t"MX": "113583175941450",  // iProspect\n\t\t"NL": "656219287899900", // iProspect\n\t\t"NO": "1675926909345981",  \n\t\t"NZ": "1925863447693257", // iProspect 9/13/17\n\t\t"PH" : "109126313071654", // iProspect  (NEW)\n\t\t"PT" : "1368140109922230",\n\t\t"RU": "514282922073511",  \n\t\t"SE": "1400129366740315", // iProspect\n\t\t"SG": "1240252356085595", // iProspect\n\t\t"TW": "266771177060777",  // iProspect\n\t\t"US": "141890703034968" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t"fr-ca": "165913903949482",  \n\t\t"hi-in": "1419329368162069", \n\t\t"nl-be": "129122374248830", \n\t\t"de-ch": "1674321202841213", // iProspect\n\t\t"never": "1111111111111111"\n\t};\n\t\n\tvar baseurl="",imgurlcart="",imgurlpurchase="",imgurllead="",dbugimgurl="";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs="";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\tvar feedID="";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\tif (_TMDL.cc=="Unknown" && _TMDL.geo=="US") {_TMDL.cc="USD";}\n\n\tbaseurl = "https://www.facebook.com/tr?id="; \n\n\tpageviewurl = baseurl+"1770559986549030"+"&ev=PageView"+"&dpo=LDU&dpoco=0&dpost=0"+"&ts="+ts;\n\tiniturl = baseurl+"1770559986549030"+"&ev=PixelInitialized"+"&dpo=LDU&dpoco=0&dpost=0"+"&ts="+ts;\n\tpdpurl = baseurl+"1770559986549030"+"&ev=ViewContent"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n        +"&cd[content_ids]=["+encodeURIComponent(_TMDL.pidsku.join(",").toLowerCase()) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(_TMDL.pnames.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\tif (_TMDL.isprod)\n\t{\n\t\tdbugimgurl = initurl; \n\t\tBootstrapper.imageRequest(initurl);\n\t\tBootstrapper.imageRequest(initurl.replace("1770559986549030"));\t\n\t\tdbugimgurl = pageviewurl;\n\t\tBootstrapper.imageRequest(pageviewurl);\t\n\t\tBootstrapper.imageRequest(pageviewurl.replace("1770559986549030"));\t\n\t\tif (_TMDL.pageType=="detail" || _TMDL.pageType=="pdp") {\n\t\t\tdbugimgurl = pdpurl; \n\t\t\tBootstrapper.imageRequest(pdpurl);\t\n\t\t\tBootstrapper.imageRequest(pdpurl.replace("1770559986549030"));\t\n\t\t} \n\t}\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push(\'"\'+_TMDL.pidsku[i]+\'"\');\n\t\tpnamearr.push(\'"\'+_TMDL.pnames[i]+\'"\');\n\t}\n\n\timgurlcart = baseurl+"1770559986549030"+"&ev=AddToCart"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",").toLowerCase()) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\timgurlpurchase = baseurl+"1770559986549030"+"&ev=Purchase"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[currency]="+_TMDL.cc\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",").toLowerCase()) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\t// Digital Games or Xbox Passes\n  \tif (feedID && _TMDL.isprod && (typeof _TMDL.prdType[0] !== \'undefined\') && (typeof _TMDL.pnames[0] !== \'undefined\') && (_TMDL.prdType[0]=="Games" || ( ~_TMDL.prdType[0].indexOf("Pass") && ~_TMDL.pnames[0].indexOf("Xbox")))) {\n\t\t$(document).on(\'mousedown\',\'button[id*="BuyButton"]\',\'\', function() {\n\t\t\tdbugimgurl = imgurlcart;\n\t\t\tBootstrapper.imageRequest(imgurlcart);\n\t\t\tBootstrapper.imageRequest(imgurlcart.replace("1770559986549030"));\t\n\t\t});\n\t\t_TMDL.fbpchurl = imgurlpurchase;\n\t}\n\n\timgurllead = baseurl+"1770559986549030"+"&ev=Lead"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",").toLowerCase()) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\t\t\n\tif (feedID && ~window.location.pathname.indexOf("/p/") && typeof _TMDL.prdType[0] !== \'undefined\' && (_TMDL.prdType[0]=="Devices" || _TMDL.prdType[0]=="Passes" || _TMDL.prdType[0]=="Bundles")) {\n\t\t$(document).on(\'mousedown\',\'button[id*="AddToCartButton"],button[id*="buttons_BuildABundleButton"],button[id*="ConfigureDeviceButton"],a[href*="student-discounts?successurl"]\',\'\', function() {\n\t\t\tdbugimgurl = imgurllead;\n\t\t\tBootstrapper.imageRequest(imgurllead);\n\t\t\tBootstrapper.imageRequest(imgurllead.replace("1770559986549030"));\t\n\t\t});\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("FB LP",err.message,dbugimgurl);}\n\t_satellite.logger.error("FB LP");\t\n}',language:"javascript"}}]},{id:"RLc2d5fa61d50b4b45a207ebcf269f2176",name:"CopilotPro/US",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/copilotpro",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2024-04-09T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var trialClick = \'a[href*="LinkID=2243582"]\';\n    attachPixels(trialClick);\n} catch (e) {\n    console.log("Rule has failed");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var pid = $(this).attr("data-bi-pid");\n        pid = pid === undefined ? "cfq7ttc0mntq" : pid;\n        var pname = $(this).attr("data-bi-ehn");\n        var cta = $(this).attr("data-bi-cn");\n\n        var yahoo = new Image(1, 1);\n        yahoo.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&hph={INSERT_MACRO_HERE}&ea=BuyCopilotPro";\n\n        var xandr = new Image(1, 1);\n        xandr.src = "https://secure.adnxs.com/px?id=1773571&t=2";\n\n        var linkedIn = new Image(1, 1);\n        linkedIn.src = "https://px.ads.linkedin.com/collect/?pid=7850&fmt=gif";\n\n        var meta = new Image(1, 1);\n        meta.src = "https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1";\n\n        var floodlight = new Image(1, 1);\n        floodlight.src = "https://ad.doubleclick.net/ddm/activity/src=8406157;type=stoth;cat=copilot;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll +";u6=" + _TMDL.pageName +";u25=" + pid +";u26=" + pname +";u50=" + cta +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n    });\n}',language:"javascript"}}]},{id:"RLc9e376cf2f044bc587f315a3936829f0",name:"US/DE/JP Comscore Surface",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(de-de|en-us|ja-jp)/d/surface-pro-9/",valueIsRegex:!0},{value:"/(de-de|en-us|ja-jp)/d/surface-laptop-5/",valueIsRegex:!0},{value:"/(de-de|en-us|ja-jp)/store/configure/surface-pro-9/93vkd8np4fvk",valueIsRegex:!0},{value:"/(de-de|en-us|ja-jp)/store/configure/surface-laptop-5/8xn49v61s1bn",valueIsRegex:!0},{value:"/en-us/microsoft-365/buy/compare-all-microsoft-365-products",valueIsRegex:!0},{value:"/en-us/d/surface-pro-9-for-business/8xjc219dg79z",valueIsRegex:!0},{value:"/en-us/d/surface-pro-8-for-business/8x957cqqp1t4",valueIsRegex:!0},{value:"/en-us/d/surface-go-4-for-business/8qczkbwf3t77",valueIsRegex:!0},{value:"/en-us/d/surface-go-3-for-business/8msjbnl8hbxw",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-5-for-business/8wx8rsm6l09n",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-4-for-business/929894rg3gd7",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-2-for-business/935xfv68l29f",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-for-business/8wvj5p8dd2th",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-3-for-business/90qlzjm26q6s",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-2-for-business/8vw8gdhtn92d",valueIsRegex:!0},{value:"/en-us/d/surface-pro-9-for-business-essentials-bundle/8nd51zvkkxwz",valueIsRegex:!0},{value:"/en-us/d/surface-pro-8-for-business-essentials-bundle/8wxf074l71zp",valueIsRegex:!0},{value:"/en-us/d/surface-go-4-for-business-essentials-bundle/90q5n4b7xwvh",valueIsRegex:!0},{value:"/en-us/d/surface-go-3-for-business-essentials-bundle/92lclmzs07cm",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-5-for-business-essentials-bundle/8nczs6n6k6k2",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-4-for-business-essentials-bundle/90mrqz4cb2mp",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-2-for-business-essentials-bundle/8n9bx99ffgz7",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-for-business-essentials-bundle/8v7qcgx7j27q",valueIsRegex:!0},{value:"/en-us/d/xbox-series-s-gilded-hunter-bundle/92hndf5m5291",valueIsRegex:!0},{value:"/en-us/d/Surface-Laptop-Go-2-for-Business-Essentials-Bundle/94j25vhqh58r",valueIsRegex:!0},{value:"/en-us/d/surface-pro-9-essentials-bundle/944qkwh6r8ds",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-5-essentials-bundle/8rnkq7msksmf",valueIsRegex:!0},{value:"/en-us/d/surface-go-3-essentials-bundle/8p5dqh206jw0",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-4-essentials-bundle/8q410j30qwvb",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-2-essentials-bundle/8s2f4n61zn15",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-3-essentials-bundle/90mfgpb9pxgf",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-2-essentials-bundle/8rpj1ck09v7t",valueIsRegex:!0},{value:"/en-us/d/surface-pro-9-and-pro-keyboard-bundle/93x926bp90dx",valueIsRegex:!0},{value:"/en-us/d/surface-go-3/904h27d0cbwn",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-4/946627fb12t1",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-2/8rqr54krf1dz",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-3/8p0wwgj6c6l2",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-2/8pglpv76mjhn",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Pro-9-for-Business/8xjc219dg79z",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Pro-8-for-Business/8x957cqqp1t4",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Go-4-for-Business/8qczkbwf3t77",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Go-3-for-Business/8msjbnl8hbxw",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-5-for-Business/8wx8rsm6l09n",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-4-for-Business/929894rg3gd7",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Studio-2-for-Business/935xfv68l29f",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Studio-for-Business/8wvj5p8dd2th",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Go-3-for-Business/90qlzjm26q6s",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Go-2-for-Business/8vw8gdhtn92d",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Pro-9-for-Business-Essentials-Bundle/8nd51zvkkxwz",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Pro-8-for-Business-Essentials-Bundle/8wxf074l71zp",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Go-4-for-Business-Essentials-Bundle/90q5n4b7xwvh",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Go-3-for-Business-Essentials-Bundle/92lclmzs07cm",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-5-for-Business-Essentials-Bundle/8nczs6n6k6k2",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-4-for-Business-Essentials-Bundle/90mrqz4cb2mp",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Studio-2-for-Business-Essentials-Bundle/8n9bx99ffgz7",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Studio-for-Business-Essentials-Bundle/8v7qcgx7j27q",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Go-3-for-Business-Essentials-Bundle/92hndf5m5291",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Go-2-for-Business-Essentials-Bundle/94j25vhqh58r",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Pro-9-Essentials-Bundle/944qkwh6r8ds",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-5-Essentials-Bundle/8rnkq7msksmf",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Go-3-Essentials-Bundle/8p5dqh206jw0",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-4-Essentials-Bundle/8q410j30qwvb",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Studio-2-Essentials-Bundle/8s2f4n61zn15",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Go-3-Essentials-Bundle/90mfgpb9pxgf",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Go-2-Essentials-Bundle/8rpj1ck09v7t",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Pro-9-and-Pro-Keyboard-Bundle/93x926bp90dx",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Go-3/904h27d0cbwn",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-4/946627fb12t1",valueIsRegex:!0},{value:"/en-us/store/configure/surface-laptop-studio-2/8rqr54krf1dz",valueIsRegex:!0},{value:"/en-us/store/configure/surface-laptop-go-3/8p0wwgj6c6l2",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Go-2/8pglpv76mjhn",valueIsRegex:!0},{value:"/en-us/store/b/copilotpro",valueIsRegex:!0},{value:"/en-us/d/surface-pro-10-for-business/8v73d6qwrss1",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Pro-10-for-Business/8v73d6qwrss1",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-6-for-business/8pz3fvs57qcv",valueIsRegex:!0},{value:"/en-us/store/configure/surface-laptop-6-for-business/8pz3fvs57qcv",valueIsRegex:!0},{value:"/en-us/.*/(9012t0lxhjnf|9012T0LXHJNF)",valueIsRegex:!0},{value:"/en-us/.*/(92vpfztck8h9|92VPFZTCK8H9)",valueIsRegex:!0},{value:"/en-us/.*/(94BF9JDFDDQP|94bf9jdfddqp)",valueIsRegex:!0},{value:"/en-us/.*/(8sgwwqqlp3df|8SGWWQQLP3DF)",valueIsRegex:!0},{value:"/en-us/.*/(8n9t09p96cmj|8N9T09P96CMJ)",valueIsRegex:!0},{value:"/en-us/.*/(8tq2hq5xxkj9|8TQ2HQ5XXKJ9)",valueIsRegex:!0},{value:"/en-us/.*/(8tkcbz02bdvk|8TKCBZ02BDVK)",valueIsRegex:!0},{value:"/en-us/.*/(8nl1w61jw8zm|8NL1W61JW8ZM)",valueIsRegex:!0},{value:"/en-us/d/Xbox-Series-X-2TB-Galaxy-Black-Special-Edition/8smbrt7wmfp9",valueIsRegex:!0},{value:"/en-us/d/Xbox-Series-X-1TB-Digital-Edition-%28White%29/8z1l85h2g116",valueIsRegex:!0},{value:"/en-us/d/Xbox-Series-S-1TB-%28White%29/8r02lkf9q26r",valueIsRegex:!0},{value:"/en-us/d/xbox-series-x/8wj714n3rbtl",valueIsRegex:!0},{value:"/en-us/d/xbox-series-x-certified-refurbished/8q7bghmlgdjv",valueIsRegex:!0},{value:"/en-us/d/xbox-series-s-1tb-black-certified-refurbished/8mbxhqt38ztw",valueIsRegex:!0},{value:"/en-us/d/xbox-wireless-controller/8xn59crbsqgz",valueIsRegex:!0},{value:"/en-us/d/xbox-elite-wireless-controller-series-2-core/8v7m3k0bsh52",valueIsRegex:!0},{value:"/en-us/d/xbox-elite-wireless-controller-series-2/8rsn7j6375gg",valueIsRegex:!0},{value:"/en-us/d/xbox-series-x-certified-refurbished/8q7bghmlgdjv",valueIsRegex:!0},{value:"/en-us/d/xbox-series-s-1tb-black-certified-refurbished/8mbxhqt38ztw",valueIsRegex:!0},{value:"/en-au/microsoft-365/buy/compare-all-microsoft-365-products",valueIsRegex:!0},{value:"/en-us/.*/(93dzmw6q4w2b|93DZMW6Q4W2B)",valueIsRegex:!0},{value:"/en-us/.*/(8qfmn9xp1rl9|8QFMN9XP1RL9)",valueIsRegex:!0},{value:"/en-us/.*/(9012t0lxhjnf|9012T0LXHJNF)",valueIsRegex:!0},{value:"/en-us/store/configure/.*/(8mzbmmcjzqv3|8mzbmmcjzqv2|8mzbmmcjzqc4|8mzbmmcjzqjk)",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"<script src=https://www.microsoft.com/library/svy/store/broker.js></script>",language:"html"}}]},{id:"RLd73c3b4bf4e447aa9825807eb823eca1",name:"Media_/LL-LL/d/surface Twitter (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/d/surface",valueIsRegex:!0},{value:"/d/surface/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface",valueIsRegex:!0},{value:"/en-us/d/surface/",valueIsRegex:!0}]},negate:!0}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  \n  //Page Load\n  var image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  var image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n\n  \n   //Configure Now button\njQuery("button.c-button.f-primary:eq(0)").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9u&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);  \n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n  \n   //Surface Laptop Go for Business Button\njQuery("a.c-hyperlink:eq(2)").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/d/surface Twitter (RT)");\n}',language:"javascript"}}]},{id:"RLde28aecd30d74703bdf3a1ed721c0109",name:"Media.LL-LL.store.b.student",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/store/b/student"},{value:"/en-gb/store/b/student/"},{value:"/fr-fr/store/b/student"},{value:"/fr-fr/store/b/student/"},{value:"/de-de/store/b/student"},{value:"/de-de/store/b/student/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n  {\n    \n //ADNXS\n    \n //Hero\njQuery(".m-hero").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n \n//QuickLinks\njQuery(".m-updated-quicklinks li:lt(2)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n\n    \n //"Shop Surface" - Only capturing first \'card\' (anchor + img). Remainder of isn\'t identified in spec.   \njQuery("#primaryR5 img:eq(0)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n \njQuery("#primaryR5 a:eq(0)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n    \n//Surface Bundles\njQuery("#primaryR7 a:gt(1)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n    \n\n //DoubleClick\n    \njQuery(".m-hero").on("mousedown", function(){\nBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Learn More"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery(".m-updated-quicklinks li:lt(2)").on("mousedown", function(){\nBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Surface for Students Surface Accessories"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery("#primaryR5").on("mousedown", function(){ Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Surface"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery("#primaryR7 a:gt(1)").on("mousedown", function(){ Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Surface"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n \n    \n  }\ncatch(err)\n  {\n\t_satellite.logger.error("Media.LL-LL.store.b.student");\n  }',language:"javascript"}}]},{id:"RLde75a20693bd4fb18a1f30e9505db8c0",name:"Media_/en-us/ TikTok Clicks",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/",valueIsRegex:!0},{value:"/en-us/p/",valueIsRegex:!0},{value:"/en-us/store/configure/Surface",valueIsRegex:!0},{value:"/en-gb/d/",valueIsRegex:!0},{value:"/fr-fr/d/",valueIsRegex:!0},{value:"/de-de/d/",valueIsRegex:!0},{value:"/en-gb/p/",valueIsRegex:!0},{value:"/fr-fr/p/",valueIsRegex:!0},{value:"/de-de/p/",valueIsRegex:!0},{value:"/en-gb/store/configure/Surface",valueIsRegex:!0},{value:"/fr-fr/store/configure/Surface",valueIsRegex:!0},{value:"/de-de/store/configure/Surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try {\n//PlaceAnOrder\njQuery(\"button:contains('Buy')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('PlaceAnOrder', ttp);\n  });\n        \n//AddToCart\njQuery(\"button:contains('Add to cart')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.content_type = _TMDL.prdType;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('AddToCart', ttp);\n  });\n  \n//ClickButton\njQuery(\"button:contains('Rent'), button:contains('Get'), button:contains('Free'), button:contains('Configure now')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('ClickButton', ttp);  \n  });                                                                  \n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-us/ TikTok Clicks\");\n}",language:"javascript"}}]},{id:"RLef0315aa87014acb9bc9a60708599d11",name:"VRZNLPXbox",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/en-us/p/xbox.*",valueIsRegex:!0},{value:"^/de-de/p/xbox.*",valueIsRegex:!0},{value:"^/fr-fr/p/xbox.*",valueIsRegex:!0},{value:"^/en-gb/p/xbox.*",valueIsRegex:!0},{value:"^/en-au/p/xbox.*",valueIsRegex:!0},{value:"^/jp-jp/p/xbox.*",valueIsRegex:!0},{value:"^/en-ca/p/xbox.*",valueIsRegex:!0},{value:"^/fr-ca/p/xbox.*",valueIsRegex:!0},{value:"^/en-us/d/xbox.*",valueIsRegex:!0},{value:"^/de-de/d/xbox.*",valueIsRegex:!0},{value:"^/fr-fr/d/xbox.*",valueIsRegex:!0},{value:"^/en-gb/d/xbox.*",valueIsRegex:!0},{value:"^/en-au/d/xbox.*",valueIsRegex:!0},{value:"^/jp-jp/d/xbox.*",valueIsRegex:!0},{value:"^/en-ca/d/xbox.*",valueIsRegex:!0},{value:"^/fr-ca/d/xbox.*",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  var image = new Image(1,1);\n  image.src = "//sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=ViewProduct&product_id=" + _pageBITags.pageContracts.ProductInfo.id + "-" + _pageBITags.pageContracts.ProductInfo.sku;\n}\ncatch(err)\n{\n\t_satellite.logger.error("Verizon_LP");\n}',language:"javascript"}}]},{id:"RLf59cc3afd51d44a0ab67112e57bf6e7c",name:"BINGLPCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()||"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){-1!==window.location.search.indexOf("pN=cart")||window.location.search.indexOf("pN=congrats")}},negate:!0}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// BINGUET\ntry\n{\n\t(function (w, d, t, r, u) {\n\t\tvar f,\n\t\tn,\n\t\ti;\n\t\tw[u] = w[u] || [],\n\t\tf = function () {\n\t\t\tvar o = {\n\t\t\t\tti: "4000034", navTimingApi:true  // set navTimingApi flag\n\t\t\t};\n\t\t\to.q = w[u],\n\t\t\tw[u] = new UET(o),\n\t\t\tw[u].push("pageLoad")\n\t\t},\n\t\tn = d.createElement(t),\n\t\tn.src = r,\n\t\tn.async = 1,\n\t\tn.onload = n.onreadystatechange = function () {\n\t\t\tvar s = this.readyState;\n\t\t\ts && s !== "loaded" && s !== "complete" || (f(), n.onload = n.onreadystatechange = null)\n\t\t},\n\t\ti = d.getElementsByTagName(t)[0],\n\t\ti.parentNode.insertBefore(n, i)\n\t})(window, document, "script", "//bat.bing.com/bat.js", "uetq");\n\n\tvar totamount = 0,\n\t  totvalstring = "",\n\t  googpagetype = "other",\n\t  prodstring = "",\n\t  img="";\n\tvar pagetypemap = {\n\t  // old : [new, eventname]\n\t  "home": ["general_visitor","page_view"],\n\t  "search": ["search_results","view_search_results"],\n\t  "detail": ["general_visitor","view_item"],\n\t  "category": ["general_visitor","view_item_list"],\n\t  "checkout_shopping_cart": ["cart","add_to_cart"],\n\t  "cart": ["cart","add_to_cart"],\n\t  "receipt": ["purchase","Purchase"]\n\t};\n\n\tvar lineitemObj={};\n\tvar itemsArray=[];\n\n\tvar tempobj = {};\n\tvar eventname="page_view";\n\n\tif (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()][0];\n\t\teventname = pagetypemap[_TMDL.pageType.toLowerCase()][1];\n\t}\n\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t  //TODO add name\n\t\titemsArray.push({\'id\' : _TMDL.pidsku[i], \'category\': (typeof _TMDL.dcmcat ==\'object\')?_TMDL.dcmcat[i]:\'\', \'price\' : _TMDL.sales[i], \'name\' : _TMDL.pnames[i]});\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t}\n    \n\tif (~window.location.pathname.indexOf("/b/")) {\n\t\tgoogpagetype="category";\n\t} else if (~window.location.pathname.indexOf("/p/")) {\n\t\tgoogpagetype="product";\n\t}\n    \n\twindow.uetq = window.uetq || [];\n\n\tif (_TMDL.pidsku.length > 0) {\n\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : "";\n\t\ttempobj.ecomm_pagetype = googpagetype;\n\t\t//tempobj.ecomm_items = itemsArray;\n\t\ttempobj.items = itemsArray;\n\t}\n\n\tif (~_TMDL.pageType.indexOf("cart") || ~_TMDL.pageType.indexOf("receipt")) {\n\t\ttempobj.currency = _TMDL.cc;\n\t\ttempobj.revenue_value = totamount;\n\t\ttempobj.transaction_id = _TMDL.purchaseID;\n\t}\n\n\twindow.uetq.push(\'event\',eventname, tempobj); \n}\ncatch(err)\n{\n\t_satellite.logger.error("BINGLPCVF");\t\n}\n\n',language:"javascript"}}]},{id:"RLf6485d219649415ab9f7aef1461c1c3a",name:"DCMLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'try\n{\n\tvar doFloodlights = function(debug) {\n\t\ttry {\n\t\t\t_TMDL.dcmcat = [];\n\n\t\t\tvar imgsrc1,imgsrc2,imgsrc3,imgscr4;\n\t\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\t\t\tvar mc1 = "";\n\t\t\tvar pth = window.location.pathname.toLowerCase();\n\t\t\tvar pthmatch;\n\t\t\t\n\t\t\t// office and surface don\'t have the same structure for "cat" parameter\n\t\t\tvar landingpageCountFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=phy_std",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=phy_std",\n\t\t\t\t\tothersoftware : "/src=8406724;type=sftw;cat=phy_std",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_phy",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=phy_std",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=phy_std",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=phy_std",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=phy_std",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=phy_std",\n\t\t\t\t\toffice : "/src=8406097;type=ofco;cat=lpst_std",  // nonstandard\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "/src=8406157;type=stoth;cat=phy_std"\t\n\t\t\t};\n\n\t\t\tvar genericLandingpageFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=lp_std",\n\t\t\t\t\twindowssoftware : "exclude",\n\t\t\t\t\tothersoftware : "exclude",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_std",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=lp_std",\n\t\t\t\t\txboxgames : "/src=8406391;type=xbxgms;cat=lp_std",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=lp_std",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=gplp_std",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=lp_std",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=lp_std",\n\t\t\t\t\toffice : "exclude",  // nonstandard\n\t\t\t\t\tminecraft : "/src=8400687;type=mc;cat=lp_std",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\t\t\t\n\t\t\tvar landingpageUniqueFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=phy_uni",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=phy_uni",\n\t\t\t\t\tothersoftware : "/src=8406724;type=sftw;cat=phy_uni",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_uni",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=phy_uni",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=phy_uni",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=phy_uni",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=phy_uni",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=phy_uni",\n\t\t\t\t\toffice : "/src=8406097;type=ofco;cat=lp_uni",  // nonstandard\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\n\t\t\t// only windowssoftware has a PrdCatVue tag (WindowsSoftware_GBL_PrdCatVue_Count_PhysicalStore)\n\t\t\tvar categoryFloodlights = {\n\t\t\t\t\twindowsdevices : "exclude",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=pdcv_phy",\n\t\t\t\t\tothersoftware : "exclude",\n\t\t\t\t\tsurface : "exclude",\n\t\t\t\t\txboxplatform : "exclude",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "exclude",\n\t\t\t\t\txboxgamepass : "exclude",\n\t\t\t\t\txboxlive : "exclude",\n\t\t\t\t\thololens : "exclude",\n\t\t\t\t\toffice : "exclude",\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\n\t\t\tvar pdpFloodlights = {\n\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=prdv_std",  // nonstandard\n\t\t\t\twindowssoftware : "/src=8406727;type=wsft_sls;cat=pdv_phy",\n\t\t\t\tothersoftware : "/src=8406724;type=sftw_sls;cat=pdv_phy",\n\t\t\t\tsurface : "/src=8400690;type=surf;cat=prdv_std",  // nonstandard\n\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=pdv_phy",\n\t\t\t\txboxgames : "xboxgames",\n\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl_sls;cat=pdv_phy",\n\t\t\t\txboxgamepass : "/src=8406391;type=xgpg_sls;cat=pdv_phy",\n\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=pdv_phy",\n\t\t\t\thololens : "/src=8391509;type=hll;cat=pdv_phy",\n\t\t\t\toffice : "/src=8406097;type=ofco;cat=prdv_std",  // nonstandard\n\t\t\t\tminecraft : "exclude",\n\t\t\t\tother : "exclude"\n\t\t\t};\n\t\t\t\n\t\t\tvar categoryCounts = {\n\t\t\t\twindowsdevices : 0,\n\t\t\t\twindowssoftware : 0,\n\t\t\t\tothersoftware : 0,\n\t\t\t\tsurface : 0,\n\t\t\t\txboxplatform : 0,\n\t\t\t\txboxgames : 0,\n\t\t\t\txboxdesignlabs : 0,\n\t\t\t\txboxgamepass : 0,\n\t\t\t\txboxlive : 0,\n\t\t\t\thololens : 0,\n\t\t\t\toffice : 0,\n\t\t\t\tminecraft : 0,\n\t\t\t\tother : 0\n\t\t\t};\n\t\t\t\n\t\t\tvar matchWindowBrand = function(pname) {\n\t\t\t\tvar brandnames = [\n\t\t\t\t\t["acer","windowsdevices"],\n\t\t\t\t\t["alienware","windowsdevices"],\n\t\t\t\t\t["asus","windowsdevices"],\n\t\t\t\t\t["cyberpowerpc","windowsdevices"],\n\t\t\t\t\t["dell","windowsdevices"],\n\t\t\t\t\t["hp","windowsdevices"],\n\t\t\t\t\t["huawei","windowsdevices"],\n\t\t\t\t\t["ibuypower","windowsdevices"],\n\t\t\t\t\t["lenovo","windowsdevices"],\n\t\t\t\t\t["linx","windowsdevices"],\n\t\t\t\t\t["logah","windowsdevices"],\n\t\t\t\t\t["millet","windowsdevices"],\n\t\t\t\t\t["porsche","windowsdevices"],\n\t\t\t\t\t["razer","windowsdevices"],\n\t\t\t\t\t["samsung","windowsdevices"],\n\t\t\t\t\t["toshiba","windowsdevices"],\n\t\t\t\t\t["/collections/laptops","windowsdevices"],\n\t\t\t\t\t["/store/b/pc","windowsdevices"],\t\t\n\t\t\t\t\t["/store/b/pc","windowsdevices"]\t\t\n\t\t\t\t];\n\t\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i][0])) {\n\t\t\t\t\t\tif (debug) { console.log("matched windows brand");}\n\t\t\t\t\t\treturn brandnames[i][1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\t// update pidlist\n\t\t\tvar pidlist={\n\t\t\t\t\n\t\t\t\'D76QX4BZNWK4\' : \'windowssoftware\',\n\t\t\t\'DF77X4D43RKT\' : \'windowssoftware\',\n\t\t\t\'DG7GMGF0DS12\' : \'windowssoftware\',\n\t\t\t\'DG7GMGF0DS1H\' : \'windowssoftware\',\n\t\t\t\n\t\t\t\'DG7GMGF0DST3\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST4\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST5\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST6\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DWP2\' : \'othersoftware\',  \n\n\n\t\t\t\'8MB6CR05S1QD\' : \'xboxplatform\',\n\n\t\t\t\'8MC6K8M228SK\' : \'surface\',\n\t\t\t\'8MCPZJJCC98C\' : \'surface\',\n\t\t\t\'8N1V4QJ3GQ5X\' : \'surface\',\n\t\t\t\'8NKT9WTTRBJK\' : \'surface\',\n\t\t\t\'8RKCLMWPW1PP\' : \'surface\',\n\t\t\t\'8XCW9BBPVFV9\' : \'surface\',\n\t\t\t\'907TDS4DGWWV\' : \'surface\',\n\t\t\t\'90FC23DV6SNZ\' : \'surface\',\n\t\t\t\'93LTM69S3RFF\' : \'surface\',\n\n\t\t\t\'8XF18PQZ17TS\' : \'hololens\',\n\t\t\t\'90MDTZVL02K9\' : \'hololens\',\n\t\t\t\'944XGCF64Z5B\' : \'hololens\',\n\t\t\t\n\t\t\t\'900WZDF9XJVG\' : \'xboxdesignlabs\',\n\t\t\t\'93JLLWMDZ0V7\' : \'xboxdesignlabs\',\n\t\t\t\'941H3FP99RM3\' : \'xboxdesignlabs\',\n\t\t\t\'8TBJW32WJF8C\' : \'xboxdesignlabs\',\n\t\t\t\'90T6CGN08P38\' : \'xboxdesignlabs\',\n\t\t\t\'90K4SGTLSKML\' : \'xboxdesignlabs\',\n\t\t\t\'8VK59S4SSLWD\' : \'xboxdesignlabs\',\n\t\t\t\'8TVCQSJ7V6PT\' : \'xboxdesignlabs\',\n\t\t\t\'8T07Q5SRTV11\' : \'xboxdesignlabs\',\n\t\t\t\'8VKFWF7M03NJ\' : \'xboxdesignlabs\',\n\t\t\t\'90GBR9CZBHJ9\' : \'xboxdesignlabs\',\n\t\t\t\'9355VZP4KXB8\' : \'xboxdesignlabs\',\n\t\t\t\'8QT59S4FDX8Z\' : \'xboxdesignlabs\',\n\t\t\t\n\t\t\t\'CFQ7TTC0K5ZM\' : \'xboxlive\',\n\t\t\t\n\t\t\t\'CFQ7TTC0K5F8\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FD\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BB\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BC\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BD\' : \'office\',\n\t\t\t\'8N0LL43Q1H85\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DZ\' : \'office\',\n\t\t\t\'CFQ7TTC0K5F2\' : \'office\',\n\t\t\t\'CFQ7TTC0K5F3\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BH\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D6\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D7\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CD\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CP\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CS\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CT\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D0\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DN\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DM\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FB\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FC\' : \'office\',\n\t\t\t\n            // added 4/20/20 for alta\n            \'8PC5BJBHN74P\' : \'office\',\n            \'94CM694VJ57P\' : \'office\',\n            \'900RPBX20TS6\' : \'office\',\n            \'93R684WJ71VJ\' : \'office\',\n            \'8V9J0T4JFZ6W\' : \'office\',\n            \'8NFJC88FKMRZ\' : \'office\',\n            \'8SZWM812T6N1\' : \'office\',\n            \'CFQ7TTC0K5BG\' : \'office\',\n            \'8V883X3J1V40\' : \'office\',\n            // end alta\n              \n\t\t\t\'BPSWGQBW7R3G\': \'xboxplatform\',\n\t\t\t\'9NBLGGH4PBBM\': \'xboxplatform\', \n\n\n\t\t\t\'SHOULDNEVERMATCH\' : \'pc\'\n\t\t\t};\n\n\t\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\t\n\t\t\tif ((~pth.indexOf("/d/") || ~pth.indexOf("/p/")) && _TMDL.pids && pidlist[_TMDL.pids[0]]) {\n\t\t\t\t// check pids for anything explicitly mapped\n\t\t\t\tcategoryCounts[pidlist[_TMDL.pids[0]]]++;\n\t\t\t\tif (debug) { console.log("matched PID", _TMDL.pids[0], pidlist[_TMDL.pids[0]]); }\n\t\t\t} else if (~pth.indexOf("surface") ) {\n\t\t\t\tcategoryCounts["surface"]++;\n\t\t\t} else if (~pth.indexOf("office") || ~pth.indexOf("o365")) {\n\t\t\t\tcategoryCounts["office"]++;\n\t\t\t} else if (~pth.indexOf("minecraft") ) {\n\t\t\t\tcategoryCounts["minecraft"]++;\n\t\t\t} else if (~pth.indexOf("xbox") ) {\n\t\t\t\tcategoryCounts["xboxplatform"]++;\n\t\t\t} else if (~pth.indexOf("hololens") ) {\n\t\t\t\tcategoryCounts["hololens"]++;\n\t\t\t} else {\n\t\t\t\tpthmatch = matchWindowBrand(pth);\n\t\t\t\tif (pthmatch) {\n\t\t\t\t\tcategoryCounts[pthmatch]++;\n\t\t\t\t} else {\n\t\t\t\t\t// TODO:  check if physical\n\t\t\t\t\tcategoryCounts["other"]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (_TMutils.readCookie("MC1")) {\n\t\t\t\t\tmc1 = _TMutils.readCookie("MC1").split("&")[0].split("=")[1]; //use in u58\n\t\t\t\t}\n\t\t\t} catch(mc1err) {}\t\n\n\n\t\t\t/* set the floodlights based on the page */\n\t\t\tif (_TMDL.pageType=="receipt" || _TMDL.pageType=="congrats") {\n\t\t\t\tfloodlights = purchaseFloodlights;\n\t\t\t} else if (~_TMDL.pageType.indexOf("cart")) {\n\t\t\t\tfloodlights = cartFloodlights;\n\t\t\t}\n\t\t\t\n\t\t\tif(debug) {\tconsole.log(categoryCounts); }\n\n\t\t\tfor (key in categoryCounts) {\n\n\t\t\t\tif (categoryCounts[key]>0) {\t\t\n\t\t\t\t\tif (debug) {console.log(key,categoryCounts[key],landingpageUniqueFloodlights[key],"\\n");}\n\t\t\t\t\n\t\t\t\t\t// Activity Name: Store_AllProd_GBL_LandingPageVue_Unique_\n\t\t\t\t\tif (landingpageUniqueFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity"+landingpageUniqueFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\n\t\t\t\t\t/* Activity name of this tag: Store_AllProd_GBL_LandingPageVue_Count_  */\n\t\t\t\t\tif (landingpageCountFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc2 = "https://ad.doubleclick.net/ddm/activity"+landingpageCountFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc2;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc2); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc2);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t/*  genericLandingpageFloodlights  */\n\t\t\t\t\tif (genericLandingpageFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity"+genericLandingpageFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (_TMDL.pageType=="detail" && (~_TMDL.prdType[0].toLowerCase().indexOf("device") || ~_TMDL.prdType[0].toLowerCase().indexOf("pass"))) {\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (pdpFloodlights[key] !== "exclude") {\n\t\t\t\t\t\t\t// Store_AllProd_GBL_PrdVue_Count_PhysicalStore\n\t\t\t\t\t\t\timgsrc3 = "https://ad.doubleclick.net/ddm/activity"+pdpFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames)+";u32="+_TMDL.pids+";u33="+_TMDL.pidsku+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a;\n\t\t\t\t\t\t\timgsrc = imgsrc3;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc3);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (~_TMDL.pageType.toLowerCase().indexOf("category") && ~window.location.pathname.indexOf("/b/")){\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (categoryFloodlights[key] !== "exclude") {\n\t\t\t\t\t\t\timgsrc4 = "https://ad.doubleclick.net/ddm/activity"+categoryFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n\t\t\t\t\t\t\timgsrc = imgsrc4;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc4);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (debug) { console.log(_TMDL.dcmcat) ; }\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t} catch(flerr) {\n\t\t\t_TMutils.logRuleCall("DCMLP err",flerr.name,flerr.message);\n\t\t}\n\n\t};\n\n\n\tvar pth = window.location.pathname.toLowerCase();\n\tvar debug = ~window.location.href.indexOf("debug") ? 1 : 0;\n\n\n\n\t// -----------------------------------------\n\t//   previously separate digital pages tags\n\t// -----------------------------------------\n\n\tvar _getMetaValue = function(name) {\n\t\t\treturn $(\'meta[name="\' + name + \'"]\').attr(\'content\');\n\t\t};\n\t\t\n\tvar fireDCM = function(params) {\n\t\tvar a, imgsrc1, imgsrc2;\n\t\ta = "" + (Math.random() * 10000000000000);\n\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity/"+params+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t+";u20="+_TMDL.pidsku\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n\t\timgsrc = imgsrc1;\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\tif (debug) {console.log(params);}\n\t};\n\n\tvar matchXboxBrand = function(pname) {\n\t\tvar brandnames = [\n\t\t\t"forza",\n\t\t\t"call of duty",\n\t\t\t"tomb raider",\n\t\t\t"toy soldiers war chest",\n\t\t\t"red dead"\n\t\t\t];\n\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\tvar pdpname = (_TMDL.pnames.length>0 && ~_TMDL.pnames[0]) ? _TMDL.pnames[0].toLowerCase() : "";\n\tvar isPhysicalPage = (~pth.indexOf("/store/") && pth.indexOf("/p/")<0) || (~pth.indexOf("/p/") && _TMDL.prdType[0]!=="Apps" && _TMDL.prdType[0]!=="Games");\n\tvar\ta = "" + (Math.random() * 10000000000000);\n\tvar configdeviceurl="",buildyourbundleurl="", checkeligibilityurl="", addtocarturl="";\n\tvar imgsrc="";\n\t\n\tif (isPhysicalPage) {doFloodlights(debug);}\n\n\tif (_TMDL.prdType=="Games" || _TMDL.prdType=="Passes" || _TMDL.prdType=="Apps") {\n\t\tif ( ~pth.indexOf("cfq7ttc0k5zm") || ~pth.indexOf("cfq7ttc0k5dj")) {\n\t\t\t// XboxLiveGold_GBL_PrdVue_Count_DigitalStore:  /src=8391497;type=xlg;cat=pdv_dgtl;\n\t\t\tfireDCM("src=8391497;type=xlg;cat=pdv_dgtl");  \n          $(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart");  // XboxLiveGold_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8391497;type=xlg;cat=crtd_std");\n\t\t\t});\n\t\t} else if (\t( _TMDL.prdType=="Games" && (_getMetaValue("ms\\\\.prod_worksonxbox")=="true" || matchXboxBrand(pdpname))) || (pth.indexOf("xbox") > -1) || ~pdpname.indexOf("xbox") ) {\n\t\t\t//XboxGamePassGames_GBL_PrdVue_Count_DigitalStore:  /src=8406391;type=xgpg;cat=pdv_dgtl;\n\t\t\t//console.log("XboxGamePassGames_GBL_PrdVue_Count_DigitalStore");\n\t\t\tfireDCM("src=8406391;type=xgpg;cat=pdv_dgtl");\n          $(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart"); //XboxGamePassGames_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8406391;type=xgpg;cat=crtd_std");\n\t\t\t});\n\t\t} else if (_TMDL.prdType=="Apps" || _TMDL.prdType=="Games") {\n\t\t\t//WindowsSoftware_GBL_PrdVue_Count_DigitalStore\n\t\t\t//console.log("WindowsSoftware_GBL_PrdVue_Count_DigitalStore");\n\t\t\tfireDCM("src=8406727;type=wsft;cat=pdv_dgtl");\n\t\t\t$(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart"); //WindowsSoftware_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8406727;type=wsft;cat=crtd_std");\n\t\t\t});\n\t\t}\n\t}\n\n\n\t// Surface Configure Device tag as Surface Learn More  (request from Ahmed Homsi)\n\tif (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/d/")) {\n\n\t\tconfigdeviceurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n\t\t\t+";u25="+_TMDL.pids[0]\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+";u50=Configure%20now"\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\t\timgsrc = configdeviceurl;\n\n\t\t// Configure Now CTA\n\t\t$(document).on(\'mousedown\',\'a:contains("Configure now"),button:contains("Configure now")\',\'\', function() {\n\t\t\tBootstrapper.imageRequest(configdeviceurl);\n\t\t});\n      \n      \tbuildyourbundleurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="\n    \t\t+_TMDL.geo\n    \t\t+";u2="+_TMDL.ll\n    \t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n    \t\t+";u25="+_TMDL.pids[0]\n    \t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n    \t\t+";u50=BuildYourBundle"\n    \t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\n    \t// BuildYourBundle CTA\n        $(document).on(\'mousedown\',\'a:contains("Build your bundle"),button:contains("Build your bundle"),a[href*="/store/build/"]\',\'\', function() {\n    \t\tBootstrapper.imageRequest(buildyourbundleurl);\n    \t});\n      \n\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  (src=8400690;type=surf;cat=pchn_std;)  added 5/6/19, modified 12/319 for exclusions\n\t$(document).on(\'mousedown\',\'div.pi-promotion-bar a\',\'\', function() {\n\t\tvar inScope=1;\n\t\ttry {\n\t\t\tif (~this.href.indexOf("/build/") || ~this.href.indexOf("student-discounts?successurl")) {\n\t\t\t\t_satellite.logger.log("out of scope");\n\t\t\t\tinScope=0;\n\t\t\t}\n\t\t} catch(shperr) {_satellite.logger.log("shopnow err");}\n\n\t\tif (inScope) { \n\t\t\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n\t\t\t+";u25="+_TMDL.pids[0]\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+";u50=ShopNow"\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?");\n\t\t}\n\t});\n\n        // added 12/2/19 to add in shop for business in non-promobar area\t\n        $(document).on(\'mousedown\',\'div.store-finance-offer a\',\'\', function() {\n                Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="\n                +_TMDL.geo\n                +";u2="+_TMDL.ll\n                +";u6="+encodeURIComponent(_TMDL.pagename)\n                +";u25="+_TMDL.pids[0]\n                +";u26="+encodeURIComponent(_TMDL.pnames[0])\n                +";u50=BusinessOffer"\n                +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?");\n        });\n      \n        // check your eligibility CTA\n      \tcheckeligibilityurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]\t+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=CheckYourEligibility;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n        $(document).on(\'mousedown\',"a[href*=\'student-discounts?successurl\']",\'\', function() {\n            Bootstrapper.imageRequest(checkeligibilityurl);\n        });\n      \n      \t// added 11/26/19\n\t\n        addtocarturl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=AddToCartClick"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+ a + "?";\n\n        $(document).on(\'mousedown\',\'a:contains("Add to cart"),button:contains("Add to cart")\',\'\', function() {\n            Bootstrapper.imageRequest(addtocarturl);\n        });\t\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error("DCM LP");\n}',language:"javascript"}}]}]};var _satellite=function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function e(t){return"[object Object]"===Object.prototype.toString.call(t)}function n(t){var n,o;return!1!==e(t)&&(void 0===(n=t.constructor)||!1!==e(o=n.prototype)&&!1!==o.hasOwnProperty("isPrototypeOf"))}function o(t){return"string"==typeof t&&-1!==t.indexOf("[")&&-1!==t.indexOf("]")}function a(t){return t.substr(0,t.indexOf("["))}function r(t,e,n){if(t.length&&le(e)){var s=t[0];if(1!==t.length){var i=t.slice(1);if(!o(s))return r(i,e[s],n);var c=e[s=a(s)];Array.isArray(c)&&c.forEach((function(t){return r(i,t,n)}))}else e.hasOwnProperty(s)&&"string"==typeof e[s]&&(e[s]=n(e[s]))}}if(window.atob){var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i=document,c=Object.assign,u=window,d=u,l=function(t,e,n,o){var a,r=Boolean(e&&Array.isArray(n)),s=Boolean(r&&t),i=document.createElement("a");if(r){var c=function(){var t=new Error("Unable to find the Library Embed Code for Dynamic Host Resolution.");throw t.code="dynamic_host_resolver_constructor_error",t};if(t&&(/^((https?:)?\/\/).+/.test(t)||c(),/^\/\/.+/.test(t)?i.href=d.location.protocol+t:i.href=t),i.hostname||c(),-1===n.indexOf(i.hostname)){var u=new Error("This library is not authorized for this domain. Please contact your CSM for more information.");throw u.code="dynamic_host_not_allowed",u}}var l=function(){if(null!=a)return a;if(s){var t=i.host;/:80$/.test(t)?t=t.replace(":80",""):/:80\/$/.test(t)?t=t.replace(":80/",""):/:443$/.test(t)?t=t.replace(":443",""):/:443\/$/.test(t)&&(t=t.replace(":443/","")),a=i.protocol+"//"+t}else a="";return a},p=function(t){return s&&"string"==typeof t?[l(),"/"===t.charAt(0)?t.slice(1):t].join("/"):t},g={getTurbineHost:l,decorateWithDynamicHost:p,get isDynamicEnforced(){return r}};return d&&o.onDebugChanged((function(t){t?d.dynamicHostResolver=g:delete d.dynamicHostResolver})),g},p=function(t){var e=[];return t.forEach((function(t){t.events&&t.events.forEach((function(n){e.push({rule:t,event:n})}))})),e.sort((function(t,e){return t.event.ruleOrder-e.event.ruleOrder}))},g="debug",m=function(t,e){var n=function(){return"true"===t.getItem(g)},o=function(e){t.setItem(g,e)},a=[],r=function(t){a.push(t)};return e.outputEnabled=n(),{onDebugChanged:r,getDebugEnabled:n,setDebugEnabled:function(t){n()!==t&&(o(t),e.outputEnabled=t,a.forEach((function(e){e(t)})))}}},f="Module did not export a function.",h=function(t,e,n){return function(o,a,r){r=r||[];var s=t.getModuleExports(o.modulePath);if("function"!=typeof s)throw new Error(f);var i=t.getModuleDefinition(o.modulePath),c=o.settings||{};!o.hasTransformedFilePaths&&i.filePaths&&(n(c,i.filePaths,o.modulePath),o.hasTransformedFilePaths=!0);var u=e(c,a);return s.bind(null,u).apply(null,r)}},v=function(t){return"string"==typeof t?t.replace(/\s+/g," ").trim():t},_={LOG:"log",INFO:"info",DEBUG:"debug",WARN:"warn",ERROR:"error"},b="\ud83d\ude80",w=10===parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1])?"[Launch]":b,y=!1,T=function(t){if(y&&window.console){var e=Array.prototype.slice.call(arguments,1);e.unshift(w),t!==_.DEBUG||window.console[t]||(t=_.INFO),window.console[t].apply(window.console,e)}},x=T.bind(null,_.LOG),C=T.bind(null,_.INFO),L=T.bind(null,_.DEBUG),D=T.bind(null,_.WARN),I=T.bind(null,_.ERROR),R=function(){var t=y;y=!0,T.apply(null,Array.prototype.concat(_.WARN,Array.prototype.slice.call(arguments))),t||(y=!1)},M={log:x,info:C,debug:L,warn:D,error:I,deprecation:R,get outputEnabled(){return y},set outputEnabled(t){y=t},createPrefixedLogger:function(t){var e="["+t+"]";return{log:x.bind(null,e),info:C.bind(null,e),debug:L.bind(null,e),warn:D.bind(null,e),error:I.bind(null,e)}}},k=u,j="com.adobe.reactor.",P=function(t,e){var n=j+(e||"");return{getItem:function(e){try{return k[t].getItem(n+e)}catch(t){return null}},setItem:function(e,o){try{return k[t].setItem(n+e,o),!0}catch(t){return!1}}}},S=P,B="dataElements.",E=S("sessionStorage",B),O=S("localStorage",B),q={PAGEVIEW:"pageview",SESSION:"session",VISITOR:"visitor"},A={},U=function(t){var e;try{e=JSON.stringify(t)}catch(t){}return e},N=v,F=M,G={setValue:function(t,e,n){var o;switch(e){case q.PAGEVIEW:return void(A[t]=n);case q.SESSION:return void((o=U(n))&&E.setItem(t,o));case q.VISITOR:return void((o=U(n))&&O.setItem(t,o))}},getValue:function(t,e){var n;switch(e){case q.PAGEVIEW:return A.hasOwnProperty(t)?A[t]:null;case q.SESSION:return null===(n=E.getItem(t))?n:JSON.parse(n);case q.VISITOR:return null===(n=O.getItem(t))?n:JSON.parse(n)}}},Q=function(t,e,n,o){return"Failed to execute data element module "+t.modulePath+" for data element "+e+". "+n+(o?"\n"+o:"")},V=function(t,e,n,o,a){return function(r,s){var i=e(r);if(!i)return o?"":void 0;var c,u,d=i.storageDuration;try{c=t.getModuleExports(i.modulePath),u=t.getModuleDefinition(i.modulePath)}catch(t){return void F.error(Q(i,r,t.message,t.stack))}if("function"==typeof c){var l,p=i.settings||{};!i.hasTransformedFilePaths&&u.filePaths&&(a(p,u.filePaths,i.modulePath),i.hasTransformedFilePaths=!0);try{l=c(n(p,s),s)}catch(t){return void F.error(Q(i,r,t.message,t.stack))}return d&&(null!=l?G.setValue(r,d,l):l=G.getValue(r,d)),null==l&&null!=i.defaultValue&&(l=i.defaultValue),"string"==typeof l&&(i.cleanText&&(l=N(l)),i.forceLowerCase&&(l=l.toLowerCase())),l}F.error(Q(i,r,"Module did not export a function."))}},$=v,z={text:function(t){return t.textContent},cleanText:function(t){return $(t.textContent)}},H=function(t,e,n){for(var o,a=t,r=0,s=e.length;r<s;r++){if(null==a)return;var i=e[r];if(n&&"@"===i.charAt(0)){var c=i.slice(1);a=z[c](a)}else if(a.getAttribute&&(o=i.match(/^getAttribute\((.+)\)$/))){var u=o[1];a=a.getAttribute(u)}else a=a[i]}return a},K=function(t,e,n){return function(o,a){var r;if(e(o))r=n(o,a);else{var s=o.split("."),i=s.shift();"this"===i?a&&(r=H(a.element,s,!0)):"event"===i?a&&(r=H(a,s)):"target"===i?a&&(r=H(a.target,s)):r=H(t[i],s)}return r}},W=function(t,e){return function(n){var o=n.split(".")[0];return Boolean(e(n)||"this"===o||"event"===o||"target"===o||t.hasOwnProperty(o))}},J=function(t,e,n){var o={exports:{}};return t.call(o.exports,o,o.exports,e,n),o.exports},X=J,Z=M,Y=function(){var t={},e=function(e){var n=t[e];if(!n)throw new Error("Module "+e+" not found.");return n},n=function(){Object.keys(t).forEach((function(t){try{o(t)}catch(n){var e="Error initializing module "+t+". "+n.message+(n.stack?"\n"+n.stack:"");Z.error(e)}}))},o=function(t){var n=e(t);return n.hasOwnProperty("exports")||(n.exports=X(n.definition.script,n.require,n.turbine)),n.exports};return{registerModule:function(e,n,o,a,r){var s={definition:n,extensionName:o,require:a,turbine:r};s.require=a,t[e]=s},hydrateCache:n,getModuleExports:o,getModuleDefinition:function(t){return e(t).definition},getModuleExtensionName:function(t){return e(t).extensionName}}},tt=M,et=!1,nt=function(t){return function(e,n){var o=t._monitors;o&&(et||(tt.warn("The _satellite._monitors API may change at any time and should only be used for debugging."),et=!0),o.forEach((function(t){t[e]&&t[e](n)})))}},ot=M,at=function(t,e,n){var o,a,r,s,i=[],c=function(o,a,r){if(!t(a))return o;i.push(a);var s=e(a,r);return i.pop(),null==s&&n?"":s};return o=function(t,e){var n=/^%([^%]+)%$/.exec(t);return n?c(t,n[1],e):t.replace(/%(.+?)%/g,(function(t,n){return c(t,n,e)}))},a=function(t,e){for(var n={},o=Object.keys(t),a=0;a<o.length;a++){var r=o[a],i=t[r];n[r]=s(i,e)}return n},r=function(t,e){for(var n=[],o=0,a=t.length;o<a;o++)n.push(s(t[o],e));return n},s=function(t,e){return"string"==typeof t?o(t,e):Array.isArray(t)?r(t,e):"object"==typeof t&&null!==t?a(t,e):t},function(t,e){return i.length>10?(ot.error("Data element circular reference detected: "+i.join(" -> ")),t):s(t,e)}},rt=function(t){return function(){if("string"==typeof arguments[0])t[arguments[0]]=arguments[1];else if(arguments[0]){var e=arguments[0];for(var n in e)t[n]=e[n]}}},st="undefined"!=typeof window&&window.Promise||void 0!==s&&s.Promise,it=st,ct=function(t,e,n){return function(o,a,r,s){return s.then((function(){var s,i=o.delayNext;return new it((function(e,n){var a=t(o,r,[r]);if(!i)return e();var c=o.timeout,u=new it((function(t,e){s=setTimeout((function(){e(new Error("A timeout occurred because the action took longer than "+c/1e3+" seconds to complete. "))}),c)}));it.race([a,u]).then(e,n)})).catch((function(t){return clearTimeout(s),t=e(t),n(o,a,t),it.reject(t)})).then((function(){clearTimeout(s)}))}))}},ut=st,dt=function(t,e,n,o,a){return function(r,s,i,c){return c.then((function(){var c;return new ut((function(e,n){var o=t(r,i,[i]),a=r.timeout,s=new ut((function(t,e){c=setTimeout((function(){e(new Error("A timeout occurred because the condition took longer than "+a/1e3+" seconds to complete. "))}),a)}));ut.race([o,s]).then(e,n)})).catch((function(t){return clearTimeout(c),t=e(t),o(r,s,t),ut.reject(t)})).then((function(t){if(clearTimeout(c),!n(r,t))return a(r,s),ut.reject()}))}))}},lt=st.resolve(),pt=function(t,e,n){return function(o,a){return o.conditions&&o.conditions.forEach((function(e){lt=t(e,o,a,lt)})),o.actions&&o.actions.forEach((function(t){lt=e(t,o,a,lt)})),lt=(lt=lt.then((function(){n(o)}))).catch((function(){}))}},gt=function(t){return Boolean(t&&"object"==typeof t&&"function"==typeof t.then)},mt=function(t,e,n,o){return function(a,r){var s;if(a.conditions)for(var i=0;i<a.conditions.length;i++){s=a.conditions[i];try{var c=t(s,r,[r]);if(gt(c))throw new Error("Rule component sequencing must be enabled on the property for this condition to function properly.");if(!e(s,c))return n(s,a),!1}catch(t){return o(s,a,t),!1}}return!0}},ft=function(t,e){return function(n,o){t(n,o)&&e(n,o)}},ht=function(t){return function(e){
var n=t.getModuleDefinition(e.modulePath);return n&&n.displayName||e.modulePath}},vt=function(t){return function(e){var n=e.rule,o=e.event,a=t.getModuleDefinition(o.modulePath).name;return{$type:t.getModuleExtensionName(o.modulePath)+"."+a,$rule:{id:n.id,name:n.name}}}},_t=function(t,e,n,o,a,r){return function(s,i){var c=i.rule,u=i.event;u.settings=u.settings||{};try{var d=a(i);e(u,null,[function(e){var o=n(d,e);s((function(){t(o,c)}))}])}catch(t){r.error(o(u,c,t))}}},bt=function(t,e,n,o){return function(a,r,s){var i=e(a);n.error(t(i,r.name,s)),o("ruleActionFailed",{rule:r,action:a})}},wt=function(t,e,n,o){return function(a,r,s){var i=e(a);n.error(t(i,r.name,s)),o("ruleConditionFailed",{rule:r,condition:a})}},yt=function(t,e,n){return function(o,a){var r=t(o);e.log('Condition "'+r+'" for rule "'+a.name+'" was not met.'),n("ruleConditionFailed",{rule:a,condition:o})}},Tt=function(t,e){return function(n){t.log('Rule "'+n.name+'" fired.'),e("ruleCompleted",{rule:n})}},xt=function(t,e,n){return function(o,a){var r;if(o.actions)for(var s=0;s<o.actions.length;s++){r=o.actions[s];try{t(r,a,[a])}catch(t){return void e(r,o,t)}}n(o)}},Ct=function(t,e,n,o){return function(a,r){o("ruleTriggered",{rule:r}),t?n(r,a):e(r,a)}},Lt=function(t,e,n){return'Failed to execute "'+t+'" for "'+e+'" rule. '+n.message+(n.stack?"\n"+n.stack:"")},Dt=function(t,e){return e&&!t.negate||!e&&t.negate},It=[],Rt=!1,Mt=function(t){Rt?t():It.push(t)},kt=function(t,e,n){t(e).forEach((function(t){n(Mt,t)})),Rt=!0,It.forEach((function(t){t()})),It=[]},jt=function(t){if(t||(t=new Error("The extension triggered an error, but no error information was provided.")),!(t instanceof Error)){var e="object"==typeof t?JSON.stringify(t):String(t);t=new Error(e)}return t},Pt={};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.isPlainObject=n;var St,Bt=M,Et=c,{isPlainObject:Ot}=Pt,qt=function(t,e){return Ot(e=e||{})?e=Et({},e,t):Et(e,t),e.hasOwnProperty("type")||Object.defineProperty(e,"type",{get:function(){return Bt.deprecation("Accessing event.type in Adobe Launch has been deprecated and will be removed soon. Please use event.$type instead."),e.$type}}),e},At=function(t,e){return function(n,o){var a=t[n];if(a){var r=a.modules;if(r)for(var s=Object.keys(r),i=0;i<s.length;i++){var c=s[i],u=r[c];if(u.shared&&u.name===o)return e.getModuleExports(c)}}}},Ut=function(t,e){return function(){return e?t(e):{}}},Nt=function(t,e,n){return function(o){if(n){var a=o.split(".");a.splice(a.length-1||1,0,"min"),o=a.join(".")}return t(e)+o}},Ft=".js",Gt=function(t){return t.substr(0,t.lastIndexOf("/"))},Qt=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},Vt=function(t,e){Qt(e,Ft)||(e+=Ft);var n=e.split("/"),o=Gt(t).split("/");return n.forEach((function(t){t&&"."!==t&&(".."===t?o.length&&o.pop():o.push(t))})),o.join("/")},$t={exports:{}};St=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(o){function a(){}function r(e,n,r){if("undefined"!=typeof document){"number"==typeof(r=t({path:"/"},a.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(t){}n=o.write?o.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var i="";for(var c in r)r[c]&&(i+="; "+c,!0!==r[c]&&(i+="="+r[c].split(";")[0]));return document.cookie=e+"="+n+i}}function s(t,n){if("undefined"!=typeof document){for(var a={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var i=r[s].split("="),c=i.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(i[0]);if(c=(o.read||o)(c,u)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(a[u]=c,t===u)break}catch(t){}}return t?a[t]:a}}return a.set=r,a.get=function(t){return s(t,!1)},a.getJSON=function(t){return s(t,!0)},a.remove=function(e,n){r(e,"",t(n,{expires:-1}))},a.defaults={},a.withConverter=n,a}return n((function(){}))},$t.exports=St();var zt=$t.exports,Ht={get:zt.get,set:zt.set,remove:zt.remove},Kt=st,Wt=function(t,e){return new Kt((function(n,o){e.onload=function(){n(e)},e.onerror=function(){o(new Error("Failed to load script "+t))}}))},Jt=function(t){var e={};if(!t||"string"!=typeof t)return e;var n=t.trim().replace(/^[?#&]/,""),o=new URLSearchParams(n),a=o.keys();do{var r=a.next(),s=r.value;if(s){var i=o.getAll(s);1===i.length?e[s]=i[0]:e[s]=i}}while(!1===r.done);return e},Xt=function(t){var e="{{space}}",n=new URLSearchParams;return Object.keys(t).forEach((function(o){var a=t[o];"string"==typeof t[o]?a=a.replace(/ /g,e):["object","undefined"].includes(typeof a)&&!Array.isArray(a)&&(a=""),Array.isArray(a)?a.forEach((function(t){n.append(o,t)})):n.append(o,a)})),n.toString().replace(new RegExp(encodeURIComponent(e),"g"),"%20")},Zt="@adobe/reactor-",Yt={cookie:Ht,document:i,"load-script":function(t){var e=document.createElement("script");e.src=t,e.async=!0;var n=Wt(t,e);return document.getElementsByTagName("head")[0].appendChild(e),n},"object-assign":c,promise:st,"query-string":{parse:function(t){return Jt(t)},stringify:function(t){return Xt(t)}},window:u},te=function(t){return function(e){if(0===e.indexOf(Zt)){var n=e.substr(Zt.length),o=Yt[n];if(o)return o}if(0===e.indexOf("./")||0===e.indexOf("../"))return t(e);throw new Error('Cannot resolve module "'+e+'".')}},ee=At,ne=Ut,oe=Nt,ae=M,re=Vt,se=te,ie=function(t,e,n,o,a,r,s){var i=t.extensions,c=t.buildInfo,u=t.environment,d=t.property.settings;if(i){var l=ee(i,e);Object.keys(i).forEach((function(p){var g=i[p],m=g.settings;Array.isArray(g.filePaths)&&(m=r(m,g.filePaths));var f=ne(o,m);if(g.modules){var h=ae.createPrefixedLogger(g.displayName),v=oe(s,g.hostedLibFilesBaseUrl,c.minified),_={buildInfo:c,environment:u,property:{name:t.property.name,id:t.property.id},getDataElementValue:a,getExtensionSettings:f,getHostedLibFileUrl:v,getSharedModule:l,logger:h,propertySettings:d,replaceTokens:o,onDebugChanged:n.onDebugChanged,get debugEnabled(){return n.getDebugEnabled()}};Object.keys(g.modules).forEach((function(t){var n=g.modules[t],o=se((function(n){var o=re(t,n);return e.getModuleExports(o)}));e.registerModule(t,n,p,o,_)}))}})),e.hydrateCache()}return e},ce=Ht,ue=M,de=function(t,e,n,o,a){var r=ue.createPrefixedLogger("Custom Script");t.track=function(t){ue.log('"'+t+'" does not match any direct call identifiers.')},t.getVisitorId=function(){return null},t.property={name:e.property.name,id:e.property.id},t.company=e.company,t.buildInfo=e.buildInfo,t.environment=e.environment,t.logger=r,t.notify=function(t,e){switch(ue.deprecation("_satellite.notify is deprecated. Please use the `_satellite.logger` API."),e){case 3:r.info(t);break;case 4:r.warn(t);break;case 5:r.error(t);break;default:r.log(t)}},t.getVar=o,t.setVar=a,t.setCookie=function(t,e,n){var o="",a={};n&&(o=", { expires: "+n+" }",a.expires=n);var r='_satellite.setCookie is deprecated. Please use _satellite.cookie.set("'+t+'", "'+e+'"'+o+").";ue.deprecation(r),ce.set(t,e,a)},t.readCookie=function(t){return ue.deprecation('_satellite.readCookie is deprecated. Please use _satellite.cookie.get("'+t+'").'),ce.get(t)},t.removeCookie=function(t){ue.deprecation('_satellite.removeCookie is deprecated. Please use _satellite.cookie.remove("'+t+'").'),ce.remove(t)},t.cookie=ce,t.pageBottom=function(){},t.setDebug=n;var s=!1;Object.defineProperty(t,"_container",{get:function(){return s||(ue.warn("_satellite._container may change at any time and should only be used for debugging."),s=!0),e}})},{isPlainObject:le}=Pt,pe=i,ge=c,me=l,fe=p,he=m,ve=h,_e=V,be=K,we=W,ye=Y,Te=nt,xe=at,Ce=rt,Le=ct,De=dt,Ie=pt,Re=mt,Me=ft,ke=ht,je=vt,Pe=_t,Se=bt,Be=wt,Ee=yt,Oe=Tt,qe=xt,Ae=Ct,Ue=Lt,Ne=Dt,Fe=kt,Ge=jt,Qe=qt,Ve=P,$e=ie,ze=de,He=function(t,e){return function(n,o,a){return t&&le(n)&&Object.keys(n).length&&Array.isArray(o)&&o.length?(o.forEach((function(t){Boolean(null!=a&&/^core\/.*actions.*\/customCode\.js$/.test(a))&&"source"===t&&!n.isExternal||r(t.split("."),n,e)})),n):n}},Ke=M,We=window._satellite;if(We&&!window.__satelliteLoaded){window.__satelliteLoaded=!0;var Je=We.container;delete We.container;var Xe=ge({},Je.buildInfo);Object.defineProperty(Xe,"environment",{get:function(){return Ke.deprecation("container.buildInfo.environment is deprecated.Please use `container.environment.stage` instead"),Je.environment.stage}}),Je.buildInfo=Xe;var Ze,Ye=he(Ve("localStorage"),Ke),tn="";pe.currentScript&&pe.currentScript.getAttribute("src")&&(tn=pe.currentScript.getAttribute("src"));try{Ze=me(tn,Boolean(Je.company.dynamicCdnEnabled),Je.company.cdnAllowList,Ye)}catch(t){throw Ke.warn("Please review the following error:"),t}var en,nn=He(Ze.isDynamicEnforced,Ze.decorateWithDynamicHost),on=ye(),an=Je.property.settings.undefinedVarsReturnEmpty,rn=Je.property.settings.ruleComponentSequencingEnabled,sn=Je.dataElements||{},cn=function(t){return sn[t]},un=function(){return en.apply(null,arguments)},dn=_e(on,cn,un,an,nn),ln={},pn=Ce(ln),gn=we(ln,cn),mn=be(ln,cn,dn);en=xe(gn,mn,an),ze(We,Je,Ye.setDebugEnabled,mn,pn),$e(Je,on,Ye,en,dn,nn,Ze.decorateWithDynamicHost);var fn=Te(We),hn=ve(on,en,nn),vn=ke(on),_n=Ee(vn,Ke,fn),bn=Be(Ue,vn,Ke,fn),wn=Se(Ue,vn,Ke,fn),yn=Oe(Ke,fn),Tn=Pe(Ae(rn,Me(Re(hn,Ne,_n,bn),qe(hn,wn,yn)),Ie(De(hn,Ge,Ne,bn,_n),Le(hn,Ge,wn),yn),fn),hn,Qe,Ue,je(on),Ke);Fe(fe,Je.rules||[],Tn)}return t(We)}console.warn("Adobe Launch is unsupported in IE 9 and below.")}();